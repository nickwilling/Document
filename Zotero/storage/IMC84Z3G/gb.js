$.ajaxWebServiceGlobalFalse=function(b,c,a){$.ajax({type:"POST",contentType:"application/json",url:b,data:c,dataType:"json",global:false,success:a})};$.ajaxWebService=function(b,c,a){$.ajax({type:"POST",contentType:"application/json",url:b,data:c,dataType:"json",success:a})};$.ajaxWebServiceFalse=function(b,c,a){$.ajax({type:"POST",contentType:"application/json",url:b,data:c,dataType:"json",async:false,success:a})};$.fn.loadUserControl=function(b,a){var c=this;if(a==""||a==null){a=location.pathname.replace("/","")}a+="/RenderUserControl";$.ajaxWebService(a,"{control:'"+b+"'}",function(d){c.html(d.d)})};jQuery.fn.pagination=function(b,a){a=jQuery.extend({items_per_page:10,num_display_entries:10,current_page:0,num_edge_entries:0,link_to:"#",prev_text:"Prev",next_text:"Next",ellipse_text:"...",prev_show_always:true,next_show_always:true,page_show_always:false,callback:function(){return false}},a||{});return this.each(function(){function c(){return Math.ceil(b/a.items_per_page)}function d(){var l=Math.ceil(a.num_display_entries/2);var m=c();var j=m-a.num_display_entries;var i=g>l?Math.max(Math.min(g-l,j),0):0;var k=g>l?Math.min(g+l,m):Math.min(a.num_display_entries,m);return[i,k]}function f(k,j){g=k;h();var i=a.callback(k,e);if(!i){if(j.stopPropagation){j.stopPropagation()}else{j.cancelBubble=true}}return i}function h(){e.empty();var m=d();var o=c();if(o==1&&!a.page_show_always){return}var j=function(i){return function(q){return f(i,q)}};var k=function(q,i){q=q<0?0:(q<o?q:o-1);i=jQuery.extend({text:q+1,classes:""},i||{});if(q==g){var r=jQuery("<span class='current'>"+(i.text)+"</span>")}else{var r=jQuery("<a>"+(i.text)+"</a>").bind("click",j(q)).attr("href",a.link_to.replace(/__id__/,q))}if(i.classes){r.addClass(i.classes)}e.append(r)};if(a.prev_text&&(g>0||a.prev_show_always)){k(g-1,{text:a.prev_text,classes:"prev"})}if(m[0]>0&&a.num_edge_entries>0){var p=Math.min(a.num_edge_entries,m[0]);for(var n=0;n<p;n++){k(n)}if(a.num_edge_entries<m[0]&&a.ellipse_text){jQuery("<span>"+a.ellipse_text+"</span>").appendTo(e)}}for(var n=m[0];n<m[1];n++){k(n)}if(m[1]<o&&a.num_edge_entries>0){if(o-a.num_edge_entries>m[1]&&a.ellipse_text){jQuery("<span>"+a.ellipse_text+"</span>").appendTo(e)}var l=Math.max(o-a.num_edge_entries,m[1]);for(var n=l;n<o;n++){k(n)}}if(a.next_text&&(g<o-1||a.next_show_always)){k(g+1,{text:a.next_text,classes:"next"})}}var g=a.current_page;b=(!b||b<0)?1:b;a.items_per_page=(!a.items_per_page||a.items_per_page<0)?1:a.items_per_page;var e=jQuery(this);this.selectPage=function(i){f(i)};this.prevPage=function(){if(g>0){f(g-1);return true}else{return false}};this.nextPage=function(){if(g<c()-1){f(g+1);return true}else{return false}};h();a.callback(g,this)})};(function($){jQuery.fn.extend({showTip:function(settings){$(this).each(function(){var options=jQuery.extend({flagCss:"tip",flagWidth:$(this).outerWidth(),flagInfo:$(this).attr("title"),isAnimate:false},settings);if(!options.flagInfo){return}$(this).removeAttr("title");$(this).hover(function(){options.flagWidth=(parseInt(options.flagWidth)<100)?200:parseInt(options.flagWidth);var oTip=$("<div id='mytooptip' class='ui-slider-tooltip  ui-corner-all'></div>");var oPointer=$("<div class='ui-tooltip-pointer-down'><div class='ui-tooltip-pointer-down-inner'></div></div>");var oTipInfo=$("<div>"+options.flagInfo+"</div>").attr("class",options.flagCss).css("width",options.flagWidth+"px");var oToolTip=$(oTip).append(oTipInfo).append(oPointer);if(options.isAnimate){$(oToolTip).fadeIn("slow")}$(this).after(oToolTip);var position=$(this).position();var oTipTop=eval(position.top-$(oTip).outerHeight()-8);var oTipLeft=position.left-22;$(oToolTip).css("top",oTipTop+"px").css("left",oTipLeft+"px")},function(){$("#mytooptip").remove()})});return this}})})(jQuery); 
 (function(a){a.fn.hoverDelay=function(f){var b={hoverDuring:200,outDuring:200,hoverEvent:function(){a.noop()},outEvent:function(){a.noop()}};var c=a.extend(b,f||{});var e,d,g=this;return a(this).each(function(){a(this).hover(function(){clearTimeout(d);e=setTimeout(function(){c.hoverEvent.apply(g)},c.hoverDuring)},function(){clearTimeout(e);d=setTimeout(function(){c.outEvent.apply(g)},c.outDuring)})})}})(jQuery);function InitHover(){$("#floatnavi").hoverDelay({hoverDuring:500,outDuring:0,hoverEvent:function(){$("#rehidenavlist").show()},outEvent:function(){$("#rehidenavlist").hide()}})}; 
 function GetSingleContent(ID,basePath,mark){if(mark=="read"&&!isLogin){if(typeof loginState=="undefined"||loginState<0){window.open("/"+basePath+"/LoginDigital.aspx?contentId="+encodeURIComponent(ID));return}else{if(loginState==1){window.open("/"+basePath+"/detail/detail.aspx?recid="+encodeURIComponent(ID)+"&dbCode=CRDD");return}}}var sjson="{'id': '"+escape(ID)+"'}";$.ajaxWebService("/"+basePath+"/Request/WebService.aspx/GetSingleContent",sjson,function(result){if(result.d&&result.d!=""){var restult=unescape(eval(result.d)[0].content);var loginState=$("#LoginState").attr("value");if(isLogin||loginState==0){$("#"+ID+"_1").attr("style","display:none")}$("#"+ID+"_2").attr("style","display:none");$("#"+ID).attr("style","display:block");$("#"+ID).html(unescape(eval(result.d)[0].content));SetFrameHeight()}})}; 
 var LanguageEncode="GB";var message={mostInput:"您最多只能输入",keyNum:"个字",key:"个",searchTooLongError:"检索式超长,请减少检索条件再检",reSearch:"未检索到结果，请检查检索条件!",searchWaiting:"正在查询,请稍等...",noContainRelative:"下级不包含相关检索内容",inputSearchWord1:"请输入检索词！",unLimit:"不限",papers:"系列论文集",meetings:"系列会议",mostSelect:"最多只能选择",loading:"正在加载数据,请稍等....",dataError1:"开始日期大于或者等于结束日期,请重新输入!",dataError2:"开始日期输入有误,请重新输入!",dataError3:"结束日期输入有误,请重新输入!",dataError4:"日期输入有误,请重新输入!",selectOneDB1:"请至少选择一个数据库!",noMoreDB:"不能超过15个数据库!",singleDBSelect:"只选中一个库，将进入单库导航页面!",selectNavigate:"请选择导航!",rssMessage1:"RSS文件地址已经复制到剪贴板中，您可以直接打开RSS客户端阅读软件，右键粘贴，增加频道",rssMessage2:"被浏览器拒绝！\n请在浏览器地址栏输入'about:config'并回车\n然后将'signed.applets.codebase_principal_support'设置为'true'",inputTurnPage:"请输入跳转的页数",numOnly:"只能输入数字",dingzhiMessage1:"请选择需要定制的记录！",recordOne:"只能选择一条记录！",tougaoMessage:"请选择需要投稿的记录！",navigating:"正在导航,请稍等...",zhuanyeGuan:"一次最多定制20个专业馆,请重新选择",navigate:"导航",pageError1:"页面超时，请刷新后重新操作！",leaf:"页",selectItem:"请选择项目",noKeyWord1:"没有此主题词！",searchError1:"检索出错！",CNKeyWordNum:"中文主题词  模糊查询结果：共",prePage:"上一页",nextPage:"下一页",knowledgeMessage:"知识网络中心窗口未打开，请临时关闭您的上网助手等工具。",noKeyWord2:"很抱歉，没有找到相关的文献。",serverError:"很抱歉，服务器暂时不能提供服务，请稍后再试。",totalRecorde:"共有记录",tiao:"条",qizhong:"其中",dbSelect:"数据库切换：",oneNavigateSelect:"请您至少选择一个导航条件",twoKeyWord:"同句/同段检索需要输入两个检索词",inputSearchFormula:"请输入检索式名称",inputQiKanNum:"请输入正确的期刊数",inputParms:"请输入正确的参数",inputParmsError:"您输入的参数存在非法字符,请重新输入!",reInputSearchItem:"请重新配置检索项！",groupSelect:"您可以按如下文献分组排序方式选择文献：",moreGroup:"分组只对前4万条记录分组,排序只在800万条记录以内有效",inputDate:"点击输入日期",inputISSN:"输入期刊名称，ISSN,CN均可",inputSource:"输入来源名称",inputFun1:"输入基金名称",inputAuthor1:"输入作者姓名",inputAll:"输入作者单位，全称、简称、曾用名均可",inputSearchWord2:"输入检索词:",selectOneDB2:"请您至少选择一个数据库!",noSource:"此库没有文献来源",noKeyWord:"还没有检索词,请稍后再用。",oneKeyWord:"请先输入一个词!",yourNeedKeyWord:"请输入您所需的检索词",changing:"切换中，请耐心等待……",pleaseInput:"请输入",mustSelect:"最多只能选择",noCloseWin:"系统不能弹出新页面进一步选择，请关闭您的窗口拦截功能。",noNull:"不能为空!",search:"直接检索",fontType:"宋体",searchError2:"检索项中不能输入; ' \" < >  等字符!",searchError3:"检索项不允许输入：' ;  \"  <  > 等字符！",noInput:"不能输入",more:"更多",revert:"还原",loadingData:"正在加载数据，请稍候...",sunday:"日",one:"一",two:"二",three:"三",four:"四",five:"五",six:"六",Jan:"一月",Feb:"二月",Mar:"三月",Apr:"四月",May:"五月",Jun:"六月",Jul:"七月",Aug:"八月",Sep:"九月",Oct:"十月",Nov:"十一月",Dec:"十二月",searchingLoad:"正在检索，请稍候...",pre1949:"1949以前",selectSelect:"请勾选选择对象前的复选框!",lookTxt:"查看本文在",year:"年的",knowledgeResult1:"知网节保存结果",knowledgeResult2:"知网节下载功能不能正常工作，请您暂时关闭上网助手等拦截窗口的软件。",clickInput:"点击输入",inputAuthor2:"输入作者",allSubDB:"全部子库",allXueKe:"全部学科",allSource:"全部资源",allLayer:"全部研究层次",inputFun2:"输入基金",inputUnit1:"输入作者单位",inputUnit2:"输入主办单位名称",inputUnit3:"请输入学位授予单位名称",inputUnit4:"输入出版单位名称",inputUnit5:"输入单位",inputNaming1:"输入会议名称",inputNaming2:"输入年鉴名称",inputNaming3:"输入报纸名称",inputNaming4:"输入主编或作者",inputNaming5:"输入期刊名称",noInputWord1:"不能输入：' \" ; 等字符！",noInputWord2:"不能输入：'、\"; 等字符！",atless:"请选择至少一条记录!",noBack:"未找到返回点! 请重新选择。",txting:"【全文快照】",snapSearching:"全文快照搜索",selectTime:"请选择时间！",checkFile:"请检查配置文件是否存在！",inputPage:"请输入页码！",inputPageEmsg:"请输入正确的页码！",fiveSlect:"最多选择50项",noHistory:"没有检索历史",noNullaccount:"帐号不能为空!",noNullPW:"密码不能为空!",inputUserName:"请输入用户名称",searchError4:"检索错误或记录集失效，请重新检索！",dingzhiMessage2:"请选择要定制的项",loadinging:"正在加载...",inputSearchWord3:"输入检索词",saveSelectMsg:"没有选择任何字段！",txtingError:"很抱歉，本节点文献的全文中没有您要检索的内容。",postFormTip1:"输入缺期线索的详细内容太多,应在350字以内！",postFormTip2:"上传文件不能大于4M！",postFormTip3:"请上传原刊电子版，或者输入缺期线索的详细内容！",postFormTip4:"年、期不能为空！",postFormTip5:"提交失败！",postFormTip6:"已有此文件，请您改名重新上传！",postFormTip7:"不可上传此种格式的文件！",postFormTip8:"提交成功，谢谢您的参与！",PageTurnTip:"键盘的“← →”可以实现快速翻页"}; 
 function CreateCacheSpace(a,c){var b=new CacheSpace(a,c);return b}function CacheSpace(a,b){if(!isNaN(a)){a=parseInt(a);if(a>0){a=a}}else{a=20}this.size=a;this.list=new Array();this.length=0;this.pointer=0;this.type=b}CacheSpace.prototype={find:function(a,c){var b=this.length;var d=this.defaultFind;if(typeof c=="function"){d=c}while(b--){if(d(this.list[b],a)){return b}}return -1},defaultFind:function(c,d){return c==d},enterSpace:function(a){if(typeof a!="undefined"){if(this.type==0){if(this.pointer>=this.size){this.pointer=0}this.list[this.pointer]=a;this.pointer++}else{if(this.pointer>=this.size){var b=this.list[0].time;var d=0;for(var c=1;c<this.size;c++){if(this.list[c].time<b){b=this.list[c].time;d=c}}this.list[d]=a}else{this.list[this.pointer]=a;this.pointer++}}if(this.length<this.size){this.length++}return true}return false},popSpace:function(){if(this.length>0){var a=this.list[this.pointer];this.list--;this.length--;return a}return null},clearSpace:function(){this.length=0;this.pointer=0},isEmpty:function(){if(this.length==0){return true}else{return false}}};CacheSpace.prototype.exfind=function(a){return this.find(a,function(b){return b.key==a})};CacheSpace.prototype.pushSpace=function(b,a){if(b&&a){this.enterSpace({key:b,value:a,time:1})}};CacheSpace.prototype.getExData=function(a){var b=this.getEle(a);if(b){b.time++;return b.value}return""};CacheSpace.prototype.getEle=function(a){var b=this.find(a,function(d,c){if(d){return d.key==c}return false});if(b>=0&&b<this.length){return this.list[b]}return null}; 
 var waitingTip=" ";var ISIE=navigator.userAgent.indexOf("MSIE")!=-1&&!window.opera;var isFirefox_KNS=typeof InstallTrigger!=="undefined";var isOpera_KNS=(!!window.opr&&!!opr.addons)||!!window.opera||navigator.userAgent.indexOf(" OPR/")>=0;var isSafari_KNS=Object.prototype.toString.call(window.HTMLElement).indexOf("Constructor")>0;var isIE_KNS=
/*@cc_on!@*/
false||!!document.documentMode;var isEdge_KNS=!isIE_KNS&&!!window.StyleMedia;var isChrome_KNS=!!window.chrome&&!!window.chrome.webstore;var isBlink_KNS=(isChrome_KNS||isOpera_KNS)&&!!window.CSS;var userAgent_KNS=navigator.userAgent.toLowerCase();var browser_KNS={ieQuirks:null,msie:/msie/.test(userAgent_KNS)&&!/opera/.test(userAgent_KNS),opera:/opera/.test(userAgent_KNS)};var browser_ie6=browser_KNS.msie&&/msie 6./.test(userAgent_KNS)&&typeof window.XMLHttpRequest!=="object";var browser_ie7=browser_KNS.msie&&/msie 7.0/.test(userAgent_KNS);try{if(window.HTMLElement){var outerHTMLFun1=function(c){var a=this.ownerDocument.createRange();a.setStartBefore(this);var b=a.createContextualFragment(c);this.parentNode.replaceChild(b,this);return c};var outerHTMLFun2=function(){var d;var a=this.attributes;var b="<"+this.tagName.toLowerCase();for(var c=0;c<a.length;c++){d=a[c];if(d.specified){b+=" "+d.name+'="'+d.value+'"'}}if(!this.canHaveChildren){return b+">"}return b+">"+this.innerHTML+"</"+this.tagName.toLowerCase()+">"};var outerHTMLFun3=function(){switch(this.tagName.toLowerCase()){case"area":case"base":case"basefont":case"col":case"frame":case"hr":case"img":case"br":case"input":case"isindex":case"link":case"meta":case"param":return false}return true};if(HTMLElement.prototype.__defineSetter__){HTMLElement.prototype.__defineSetter__("outerHTML",outerHTMLFun1);HTMLElement.prototype.__defineGetter__("outerHTML",outerHTMLFun2);HTMLElement.prototype.__defineGetter__("canHaveChildren",outerHTMLFun3)}else{Object.defineProperty(HTMLElement,"outerHTML",outerHTMLFun1);Object.defineProperty(HTMLElement,"outerHTML",outerHTMLFun2);Object.defineProperty(HTMLElement,"canHaveChildren",outerHTMLFun3)}}}catch(e){}function getBasePath(){var f=window.document.location.href;var c=window.document.location.pathname;var d=f.indexOf(c);var a=f.substring(0,d);var b=c.substring(0,c.substr(1).indexOf("/")+1);return(a+b)}String.prototype.format=function(){var a=arguments;return this.replace(/\{(\d+)\}/g,function(b,c){return a[c]})};String.prototype.Trim=function(){return this.replace(/(^\s*)|(\s*$)/g,"")};String.prototype.LTrim=function(){return this.replace(/(^\s*)/g,"")};String.prototype.RTrim=function(){return this.replace(/(\s*$)/g,"")};function OpenWindow(c,a,b){if(c==undefined||c==null||c==""){return}if(b==undefined||b==null||b==""){if(a==undefined||a==null||a==""){window.open(c)}else{window.open(c,a)}}else{try{window.open(c,a,b)}catch(d){window.open(c,a)}}}function ge(a){return document.getElementById(a)}function GetQueryStringByName(c,a){if("[object String]"==Object.prototype.toString.call(c)&&"[object String]"==Object.prototype.toString.call(a)){var b=c.match(new RegExp("[?&]"+a+"=([^&]+)","i"));if(b==null||b.length<1){return""}return b[1]}return""}function SetQueryStringByName(f,a,b){if("[object String]"==Object.prototype.toString.call(f)){var c=f.match(new RegExp("([?&]+)"+a+"=[^&]*","i"));var d=f;if(c!=null){d=f.replace(c[0],c[1]+a+"="+encodeURI(b))}else{d=f+"&"+a+"="+b}return d}return""}function getElementsByClassName(g,h,k,j){h=h||"*";if(!j){if(k){k=document.getElementById(k)}else{k=k||document}}if(!k){return false}var f=(h=="*"&&k.all)?k.all:k.getElementsByTagName(h);var d=new Array();g=g.replace(/\-/g,"\\-");var m=new RegExp("(^|\\s)"+g+"(\\s|$)");var b;for(var a=0,c=f.length;a<c;a++){b=f[a];if(m.test(b.className)){d.push(b)}}return d}function SetDisplayValue(b,a){var c=ge(b);if(c){if(c.style){c.style.display=a}}}function FillValue(c,a){var b=ge(c);if(b){b.value=a}}function getEmValue(b){var a=ge(b);if(a){return a.value}return""}function GetInputValue(a){return getEmValue(a)}function LoadScript(a,c){var b=document.createElement("script");b.type="text/javascript";b.src=a;document.getElementsByTagName("head")[0].appendChild(b);if(b.readyState){b.onreadystatechange=function(){if(b.readyState=="loaded"||b.readyState=="complete"){b.onreadystatechange=null;if(c){c()}}}}else{b.onload=function(){if(c){c()}}}}function J(a){return document.createElement(a)}function O(a,b,c){if(window.attachEvent){if(b=="load"&&a.readyState){a.onreadystatechange=function(){if(a.readyState=="loaded"||a.readyState=="complete"){a.onreadystatechange=null;c()}}}else{a.attachEvent("on"+b,(function(d){return function(){c.call(d)}})(a))}}else{a.addEventListener(b,c,false)}}function CoreDomainLoadJson(){this.C;this.J=J;this.O=O;this.Load=function(d,a,b){var c=document.getElementById(b);if(c){document.body.removeChild(c)}this.C=J("SCRIPT");this.C.type="text/javascript";if(typeof b=="string"&&b.length>0){this.C.id=b}else{this.C.id="callScriptE"}this.C.src=d+"&td="+(new Date()).getTime();this.C.charset="utf-8";document.body.appendChild(this.C);O(this.C,"load",a)}}function GetLoginStatus(c){var d=document.getElementById("divlogin");if(d!=null&&d!=undefined&&d!="undefined"){var b="/kns/Request/login.aspx?";if(c){b+=c}var a=new CoreDomainLoadJson();a.Load(b,function(){if(typeof oJson!="undefined"){try{var f=oJson.LoginUserHTML;if(typeof f!="undefined"&&f!=""){d.innerHTML=f}}catch(g){}}GetUserCenter($("#hid_uid").val())},"loginstatus_JS")}}function SubScription(h,b,a,d){var g=getCookie("cnkiUserKey");var c="../Request/SubScription.aspx";var f=ge("subScriptionForm");if(f){document.body.removeChild(f)}f=document.createElement("form");f.id="subScriptionForm";f.name="subScriptionForm";f.method="post";f.setAttribute("target","_blank");f.action=c;AppendElement(f,GetIntpuElement("SubT",h));AppendElement(f,GetIntpuElement("SubC",b));AppendElement(f,GetIntpuElement("SubD",a));AppendElement(f,GetIntpuElement("cnkiuserkey",g));AppendElement(f,GetIntpuElement("SubP",d));document.body.appendChild(f);f.submit();document.body.removeChild(f)}function SubScriptionToKpc(g,d){var h=getUInfoFromECP("uname");var b=getUInfoFromECP("utype");var f=GetCookie("LID");if(!h||!b||b!="jf"){OpenLoginPage();scroll(0,0);return false}var c="//ishufang.cnki.net/KPC/custom/delivery";var a=ge("subScriptionForm");if(a){document.body.removeChild(a)}a=document.createElement("form");a.id="subScriptionForm";a.name="subScriptionForm";a.method="post";a.setAttribute("target","_blank");a.action=c;AppendElement(a,GetIntpuElement("ensql",g));AppendElement(a,GetIntpuElement("dbcodes",d));document.body.appendChild(a);a.submit();document.body.removeChild(a)}function AppendElement(b,a){if(b&&a){b.appendChild(a)}}function GetIntpuElement(a,c){var b=document.createElement("input");b.setAttribute("name",a);b.setAttribute("value",c);return b}function AddFavorites(d,b){var f={};var g=navigator.userAgent.toLowerCase();var a;(a=g.match(/msie ([\d.]+)/))?f.ie=a[1]:(a=g.match(/firefox\/([\d.]+)/))?f.firefox=a[1]:(a=g.match(/chrome\/([\d.]+)/))?f.chrome=a[1]:(a=g.match(/opera.([\d.]+)/))?f.opera=a[1]:(a=g.match(/version\/([\d.]+).*safari/))?f.safari=a[1]:0;var c=d;if(document.getElementsByName(d)[0]){c=document.getElementsByName(d)[0].href}if(f.chrome){window.open("http://www.google.com/bookmarks/mark?op=edit&bkmk="+c+"&title="+b,"谷歌书签");return}if(f.firefox){window.sidebar.addPanel(b,c,"")}if(f.ie){window.external.addFavorite(c,b)}}function SetFrameHeight(){function b(j){var i=300;if(j<i){return i}return j}function c(i){if((i.contentWindow.document==document)||(i.contentWindow.document.frames.name==document.frames.name)){i.style.height=b(document.body.scrollHeight)+"px"}}function f(i){if(i.contentWindow.document==document){if(document.body.offsetHeight==0&&document.body.scrollHeight!=0){i.style.height=b(document.body.scrollHeight)+"px"}else{i.style.height=b(document.body.offsetHeight)+"px"}}}function a(i){if(document.all){a=c}else{a=f}a(i)}if(parent){var d=new Array();d=parent.document.getElementsByTagName("iframe");var h=d.length;for(var g=0;g<h;g++){a(d[g])}}}function getCookie(a,c){if(window.localStorage||window.sessionStorage){if(c=="2"){return window.sessionStorage.getItem(a)}return window.localStorage.getItem(a)}var b=a+"=";if(document.cookie.length>0){offset=document.cookie.indexOf(b);if(offset!=-1){offset+=b.length;end=document.cookie.indexOf(";",offset);if(end==-1){end=document.cookie.length}return unescape(document.cookie.substring(offset,end))}}}function GetWebUserIP(){var g=window.sessionStorage?window.sessionStorage.getItem("curUserIP"):"";var f=function(h){var d=ge("footerrightdiv");if(d){if(d.innerHTML.indexOf("您当前IP")<0){d.innerHTML+="<br/>您当前IP："+h}}};if(!g||g.length<=0){var c=new Date;var b="/kns/Request/getuserip.ashx?t="+c.getTime();var a=new CoreDomainLoadJson();a.Load(b,function(){if(typeof ipinfo!="undefined"){try{if(ipinfo.ip&&ipinfo.ip.length>0){if(window.sessionStorage){window.sessionStorage.setItem("curUserIP",ipinfo.ip)}f(ipinfo.ip)}}catch(d){}}},"getuserip_JS")}else{f(g)}}function IsWideScreen(){if(window.screen.width>=1280){return true}else{return false}}function getFocusElementId(){if(!document.activeElement){document.activeElement=null;var b=document.getElementsByTagName("*");var c=b.length;for(var a=0;a<c;a++){b[a].onfocus=function(){document.activeElement=this;return this.id}}}else{return document.activeElement.id}}function OnclickForHideMoredo(){var b=$("#flagShowHide").val();var a=getFocusElementId();if(a!="moredo"){if(b!="true"){$("#dbother_div").hide()}}}function setflag(a){$("#flagShowHide").val(a)}function modifyEcpHeader(a){$("#Ecp_header_Help").before("<a  class='ecp_tn-tab' href='//www.cnki.net/subpages/webMap.html'><i>网站地图</i></a>");$("#Ecp_header_ChargeCenter").before(grsfhtml());if(a){$(".ecp_top-nav").append(logohtml())}}function mycnkihtml(){var b="";if(getCookie("LID")){b="uid="+getCookie("LID")}var a="<span class='mycnki topItem' id='spanmycnki'>";a+="<a id='link_mycnki' href='javascript:void(0);' onclick='setmycnkiclass()'>我的记录<i class='ecp_tn-arrow'></i></a>";a+="<div id='pop_mycnki' class='topItemPop mycnkipop' style='display:none;'>";a+="<a class='close' href='javascript:void(0)' onclick='$(this).parent().hide()'>x</a>";a+="<div class='klogin_fr'>";a+="<ul class='mlist'>";a+="<li><a href='//kns.cnki.net/KMycnki/Mycnki/index?"+b+"' target='_blank'>进入 <b>我的记录</b> &gt;&gt;</a></li>";a+="<li><a href='//kns.cnki.net/KMycnki/Mycnki/index?"+b+"&amp;turnId=keyWord' target='_parent'>我的检索词</a></li>";a+="<li><a href='//kns.cnki.net/KMycnki/Mycnki/index?"+b+"&amp;turnId=recArticle' target='_parent'>我的推荐</a></li>";a+="<li><a href='//kns.cnki.net/KMycnki/Mycnki/index?"+b+"&amp;turnId=downLoad' target='_parent'>我的下载</a></li>";a+="<li><a href='//kns.cnki.net/KMycnki/Mycnki/index?"+b+"&amp;turnId=view' target='_parent'>我的浏览</a></li>";a+="<li><a href='//kns.cnki.net/KMycnki/Mycnki/index?"+b+"&amp;turnId=read' target='_parent'>我的阅读</a></li>";a+="<li><a href='//kns.cnki.net/KMycnki/Mycnki/index?"+b+"&amp;turnId=share' target='_parent'>我的分享</a></li>";a+="<li><a href='//kns.cnki.net/KMycnki/Mycnki/index?"+b+"&amp;turnId=export' target='_parent'>我的导出</a></li>";a+="<li><a href='//kns.cnki.net/KMycnki/Mycnki/index?"+b+"&amp;turnId=analysis' target='_parent'>我的分析</a></li>";a+=" <li><a href='//kns.cnki.net/knsdelivery/mycnki.aspx?"+b+"' target='_parent'>我的关注</a></li>";a+="</ul></div>";a+="<div class='klogin_fl'>";a+="<ul class='mlist'>";a+="<li class='prompt'><span>您好，登录可以查看更多信息</span></li>";a+="</ul></div></div></span>";return a}function grsfhtml(){var b=getUInfoFromECP("utype");var c=false;var f="";if(!!b&&b=="jf"){c=true;f="width:130px;"}var d="";if(getCookie("LID")){d="uid="+getCookie("LID")}var a="<span class='mycnki topItem' id='spanmycnki'>";a+="<a id='link_mycnki' href='javascript:void(0);' onclick='setmycnkiclass()'>个人书房<i class='ecp_tn-arrow'></i></a>";a+="<div id='pop_mycnki' class='topItemPop mycnkipop' style='display:none;"+f+"'>";a+="<a class='close' href='javascript:void(0)' onclick='$(this).parent().hide()'>x</a>";a+="<div class='klogin_fr'>";a+="<ul class='mlist'>";a+="<li><a href='javascript:void(0)' onclick='openKpc()'>进入 <b>个人书房</b> &gt;&gt;</a></li>";a+="<li><a href='javascript:void(0)' onclick=openKpc('fav_paper') >我的收藏</a></li>";a+="<li><a href='javascript:void(0)' onclick=openKpc('history_search') >我的历史</a></li>";a+="<li><a href='javascript:void(0)' onclick=openKpc('custom')>我的订阅</a></li>";a+="<li><a href='javascript:void(0)' onclick=openKpc('citationTracking') >引文跟踪</a></li>";a+="<li><a href='javascript:void(0)' onclick=openKpc('myAchievement') >我的成果</a></li>";a+="</ul></div>";if(!c){a+="<div class='klogin_fl'>";a+="<ul class='mlist'>";a+="<li class='prompt'><span>您好，登录个人账号可以查看更多信息</span></li>";a+="</ul></div>"}a+="</div></span>";return a}function openKpc(a){var b=getUInfoFromECP("utype");if(!b||b!="jf"){OpenLoginPage();scroll(0,0);return false}var d="";if(!!a){d="#"+a}var c="//ishufang.cnki.net/KPC?t="+Math.random()+d;window.open(c,"kns_gerenshufang");return false}function OpenLoginPage(){var f=getUInfoFromECP("uname");var b=getUInfoFromECP("utype");var c=GetCookie("LID");if(parent.$("#Ecp_top_login_layer").css("display")=="none"){parent.$("#Ecp_top_login").click()}var a="";if(!f||!b||!c){a="您好，该功能仅限个人账号使用，请您登录个人账号。"}else{if(b!="jf"){a="当前为机构账号，请您切换到个人账号，个人书房及相关个性化服务仅对个人有效。"}else{parent.$("#Ecp_top_login_layer").css("display")="none";return}}var d="<li id='alertinfo' style='width: 230px!important;margin-left: -12px!important;padding: 10px 20px!important; line-height: 20px!important; border: 1px solid #fbba05;background-color:#fffae8;color: #DA0000; '>"+a+"</li>";parent.$("#alertinfo").remove();parent.$(".loginformlist").append(d);parent.$("#Ecp_top_login_closeLayer").click(function(){parent.$("#alertinfo").remove();$("#alertinfo").remove()})}function logohtml(){var a="<div class='Logo'>";a+="<a href='//www.cnki.net'>";a+="<img src='//piccache.cnki.net/kdn/nvsmkns/images/gb/logo.gif' alt='中国知网'>";a+="<img class='logohome' src='//piccache.cnki.net/kdn/nvsmkns/images/gb/home.gif'>";a+="</a></div>";return a}function setmycnkiclass(){$("#spanmycnki").toggleClass("topItemCur");$("#pop_mycnki").toggle()}function LoginSucess(a){$.post("/kns/Loginid.aspx",{uid:a.Uid},function(){})}function Ecp_LogoutOptr(b){var a="/kns/Logout.aspx?q=-1";$.post(a,null,null);SetCookie("cnkiUserKey",SetNewGuid(),3650)}function SetCookie(a,d,b){if(GetCookie(a)==""||GetCookie(a)==null){var c=new Date();c.setDate(c.getDate()+b);document.cookie=a+"="+escape(d)+((b==null)?"":";expires="+c.toGMTString())+"; path=/;domain=cnki.net"}}function GetCookie(a){if(document.cookie.length>0){c_start=document.cookie.indexOf(a+"=");if(c_start!=-1){c_start=c_start+a.length+1;c_end=document.cookie.indexOf(";",c_start);if(c_end==-1){c_end=document.cookie.length}return decodeURIComponent(document.cookie.substring(c_start,c_end))}}return""}function SetNewGuid(){var b="";for(var c=1;c<=32;c++){var a=Math.floor(Math.random()*16).toString(16);b+=a;if((c==8)||(c==12)||(c==16)||(c==20)){b+="-"}}return b}function getUInfoFromECP(o){if(!o){return""}var ecpjosn=GetCookie("Ecp_LoginStuts");if(ecpjosn){ecpjosn=decodeURIComponent(ecpjosn);var ecpjosntype=eval("("+ecpjosn+")");switch(o){case"uname":return decodeURI(decodeURIComponent(ecpjosntype.UserName));case"utype":return ecpjosntype.UserType;case"sname":return decodeURI(decodeURIComponent(ecpjosntype.ShowName));default:return""}}return""}; 
 if(!J){J=function J(a){return document.createElement(a)}}if(!O){O=function(a,b,c){if(window.attachEvent){if(b=="load"&&a.readyState){a.onreadystatechange=function(){if(a.readyState=="loaded"||a.readyState=="complete"){a.onreadystatechange=null;c()}}}else{a.attachEvent("on"+b,(function(d){return function(){c.call(d)}})(a))}}else{a.addEventListener(b,c,false)}}}var C;function RequestJsonObject(b,a){if(C){document.body.removeChild(C)}C=J("SCRIPT");C.id="callScriptE";C.src=b+"&td="+(new Date()).getTime();C.charset="utf-8";document.body.appendChild(C);O(C,"load",a)}function RecResource(){}RecResource.prototype.SubType={CRFD:1,IMG:2,CLKL:3,SCSD:4,SCPD:5,WWJD:6,SCDB:7};RecResource.prototype.TempletType={DIV:1,TAB:2};RecResource.prototype.Templet={DIV:"",TAB:"",OTH:""};String.prototype.format=function(){var a=arguments;return this.replace(/\{(\d+)\}/g,function(b,c){return a[c]})};RecResource.prototype.GetCRFDInfoDiv=function(d,c,b){var e="http://gongjushu.cnki.net/refbook/{0}.html";var f=e.replace("{0}",d.FN);var h="";if(c){h="<dd class='more'><a onclick=\"MoreInfoSearch('CRFD','"+b+"');\" href='javascript:void(0);'>更多>></a></dd>"}var j=GetFlagTI(d.TI);var a=GetFlagTI(d.PH);var g="<div id='crfdinfodiv' class='infobox'><a href='"+f+"' target='blank' class='filtimg' onclick=WriteLog('3.10')><img src='http://epub.cnki.net"+a+"'/></a><dl><dt class='filthd'><a href='"+f+"' target='blank' onclick=WriteLog('3.10')>"+j+"</a></dt><dd class='filtbd1'>"+d.PU+"</dd><dd class='filtbd1'>"+d.AU+h+"</dl></div>";return g};RecResource.prototype.GetIMGInfoDiv=function(c,b,e){var d="";if(b){d="<dd class='more'><a onclick=\"MoreInfoSearch('IMG','"+e+"');\" href='javascript:void(0);' >更多>></a></dd>"}var g=GetFlagTI(c.TI);var a="http://image.cnki.net/detail/"+c.FN+".html";var f="<div id='imginfodiv' class='infobox'><a href='"+a+"' target='blank' class='filtimg' onclick=WriteLog('3.20')><img width='102px' src='"+c.YDZ+"'/></a><dl><dt class='filthd'><a href='"+c.MDZ+"'  target='blank' onclick=WriteLog('3.20')>"+g+"</a></dt><dd class='filtbd1'>"+c.KY+"</dd>"+d+"</dl></div>";return f};RecResource.prototype.GetCLKLInfoDiv=function(h,c,b){var e="http://law1.cnki.net/law/detail/detail.aspx?DbCode=CLKLT&dbname=&filename={0}";var a=e.format(h.FN);var g="";if(c){g="<dd class='more'><a onclick=\"MoreInfoSearch('CLKL','"+b+"');\" href='javascript:void(0);'>更多>></a></dd>"}var d=GetFlagTI(h.TI);var f="<div id='clklinfodiv' class='infobox'><dl><dt class='filthd'><a href='"+a+"' target='blank' onclick=WriteLog('3.30')>"+d+"</a></dt><dd class='filtbd1'>"+h.JB+"</dd><dd class='filtbd1'>"+h.SXX+"</dd><dd class='filtbd1'>"+h.PD+"</dd>"+g+"</dl></div>";return f};RecResource.prototype.GetSCSDInfoDiv=function(a,c,b){var e="/kns/detail/detail.aspx?dbcode=SCHF&dbname={1}&filename={0}";var g=e.replace("{0}",a.FN);g=g.replace("{1}",a.FN.substring(0,4));var h="";if(c){h="<dd class='more'><a onclick=\"MoreInfoSearch('SCSD','"+b+"');\" href='javascript:void(0);' >更多>></a></dd>"}var d=GetFlagTI(a.TI);var f="<div id='scsdinfodiv' class='infobox'><dl><dt class='filthd'><a href='"+g+"' target='blank'  onclick=WriteLog('3.40')>"+d+"</a></dt><dd class='filtbd1'>"+a.BZH+"</dd><dd class='filtbd1'>"+a.AF+"</dd>"+h+"</dl></div>";return f};RecResource.prototype.GetSCPDInfoDiv=function(a,c,b){var g="/KNS/detail/detail.aspx?dbcode=scpd&dbname={0}&filename={1}";var j=g.replace("{0}",a.BM);j=j.replace("{1}",a.FN);var e=a.LY||"";var h="";if(c){h="<dd class='more'><a onclick=\"MoreInfoSearch('SCPD','"+b+"');\" href='javascript:void(0);' >更多>></a></dd>"}var d=GetFlagTI(a.TI);var f="<div id='scpdinfodiv' class='infobox'><dl><dt class='filthd'><a href='"+j+"' target='blank'  onclick=WriteLog('3.60')>"+d+"</a></dt><dd class='filtbd1'>"+e+"</dd>"+h+"</dl></div>";return f};RecResource.prototype.GetCAPJInfoDiv=function(f,d,c){var b="/KNS/detail/detail.aspx?dbcode=cjfq&dbname={0}&filename={1}";var a=b.replace("{0}",f.BM);a=a.replace("{1}",f.FN);var h="";if(d){h="<dd class='more'><a onclick=\"MoreInfoSearch('CJFQ','"+c+"');\" href='javascript:void(0);' >更多>></a></dd>"}var j=GetFlagTI(f.TI);var e=GetFlagTI(f.AU);var g="<div id='capjinfodiv' class='infobox'><dl><dt class='filthd'><a href='"+a+"' target='blank'  onclick=WriteLog('3.70')>"+j+"</a></dt><dd class='filtbd1'>"+e+"</dd>"+h+"</dl></div>";return g};RecResource.prototype.GetWWJDInfoDivH=function(m,d,c){var g="http://scholar.cnki.net/detail/detail.aspx?tablename={0}&filename={1}";var a=g.replace("{0}",m.BM);a=a.replace("{1}",m.FN);var h=GetFlagTI(m.TI);var j=m.LY||"";var e=m.PD||"";var b=m.AU||"";var f=m.JN||"";var b=m.YE||"";var l=m.QI==null?"":"("+m.QI+")";var k="<dl><dt class='filthd'><a href='"+a+"' target='blank' class='filtimg' onclick=WriteLog('3.50')>"+h+"</a></dt><dd class='filtbd'><span class='a'>"+f+"</span><span class='b'>"+e+"</span><span class='c'>"+j+"</span></dd></dl>";return k};RecResource.prototype.GetWWJDInfoTable=function(l,j,f){var g="/kns/detail/detail.aspx?dbcode={2}&dbname={0}&filename={1}";var a=g.replace("{0}",l.BM);a=a.replace("{1}",l.FN);a=a.replace("{2}",l.BM.substring(0,4));var h=GetFlagTI(l.TI);var d=GetFlagTI(l.LY);var e=GetFlagTI(l.PD);var b=l.AU==null?"":l.AU;b=GetFlagAU(b);var k=GetFlagTI(l.JN);var m=f==true?"class='odd'":"";var c="<tr "+m+"><td class='filthd' width='60%'><a href='"+a+"' target='blank' onclick=WriteLog('3.50')>"+h+"</a></td><td  width='15%' class='rewwjd_au'>"+b+"</td><td  width='15%' class='rewwjd_jn'>"+k+"</td><td>"+e+"</td></tr>";return c};RecResource.prototype.GetSCDBInfoTable=function(h,e,f){var m="/kns/detail/detail.aspx?dbcode={2}&dbname={0}&filename={1}";var d=m.replace("{0}",h.BM);d=d.replace("{1}",h.FN);d=d.replace("{2}",h.BM.substring(0,4));var j=GetFlagTI(h.TI);var b=GetFlagTI(h.LY);var l=GetFlagTI(h.PD);var c=GetFlagTI(h.AU);var g=GetFlagTI(h.JN);var a=f==true?"class='odd'":"";var k="<tr "+a+"><td class='filthdc' width='52%'><a href='"+d+"' target='blank' onclick=WriteLog('3.70')>"+j+"</a></td><td  width='15%' class='rescdb_au'>"+c+"</td><td  width='20%' class='rescdb_jn'>"+g+"</td><td  width='8%'>"+l+"</td><td>"+b+"</td></tr>";return k};RecResource.prototype.GetResourceInfo=function(a){if(a==""){return}var b=$("#crrsPath").val();if(!b||b=="undefined"){b="http://kns.cnki.net/crrs"}this.RecURL=b+"/RelItems.ashx?keyword=";var c=this.RecURL+encodeURI(a);RequestJsonObject(c,function(){if(typeof json_result=="undefined"){return""}var l="";var m="";var g="";var n="";var k="";if(typeof json_result.CRFD!="undefined"){var e=json_result.CRFD;var h=e[0];if(h!=null&&h!=""){l=RecResource.prototype.GetCRFDInfoDiv(h,showmore)}}if(typeof json_result.IMG!="undefined"){var e=json_result.IMG;var f=e[0];if(f!=null&&f!=""){m=RecResource.prototype.GetIMGInfoDiv(f,showmore)}}if(typeof json_result.CLKL!="undefined"){var e=json_result.CLKL;var o=e[0];if(o!=null&&o!=""){g=RecResource.prototype.GetCLKLInfoDiv(o,showmore)}}if(typeof json_result.SCSD!="undefined"){var e=json_result.SCSD;var p=e[0];if(p!=null&&p!=""){n=RecResource.prototype.GetSCSDInfoDiv(p,showmore)}}if(typeof json_result.SCPD!="undefined"){var e=json_result.SCPD;var d=e[0];if(d!=null&&d!=""){k=RecResource.prototype.GetSCPDInfoDiv(d,showmore)}}var j=l+m+g+n+k;return j})};RecResource.prototype.GetResourceInfoToID=function(b,c,f,e){var a=RecResource.prototype.GetResourceInfo(b);RemoveRecDiv();if(a!=""){var d="<div id='recInfoTitle' class='wx_jsframe_jiao wx_jsframe_jiaoBlank'><strong>相关资源</strong></div><div>"+a+"</div>";if(f==0){$("#"+c).before(d)}else{if(f==1){$("#"+c).after(d)}else{$("#"+c).html(d)}}}};RecResource.prototype.GetResourceInfoToIDH=function(a,j,b,c){if(a==""){return}var d=$("#crrsPath").val();if(!d||d=="undefined"){d="http://kns.cnki.net/crrs"}var g=d+"/RelItems.ashx?keyword=";var h=g+encodeURI(a);RemoveRecDiv();var f;if(self==top){f=space3.getExData(a)}else{f=parent.space3.getExData(a)}if(f){e(f)}else{RequestJsonObject(h,function(){if(typeof json_result=="undefined"){return""}var t="";var u="";var n="";var w="";var s="";var o="";if(typeof json_result.CRFD!="undefined"){var l=json_result.CRFD;var p=l[0];if(p!=null&&p!=""){t=RecResource.prototype.GetCRFDInfoDiv(p,c,a)}}if(typeof json_result.IMG!="undefined"){var l=json_result.IMG;var m=l[0];if(m!=null&&m!=""){u=RecResource.prototype.GetIMGInfoDiv(m,c,a)}}if(typeof json_result.CLKL!="undefined"){var l=json_result.CLKL;var x=l[0];if(x!=null&&x!=""){n=RecResource.prototype.GetCLKLInfoDiv(x,c,a)}}if(typeof json_result.SCSD!="undefined"){var l=json_result.SCSD;var y=l[0];if(y!=null&&m!=""){w=RecResource.prototype.GetSCSDInfoDiv(y,c,a)}}if(typeof json_result.SCPD!="undefined"){var l=json_result.SCPD;var k=l[0];if(k!=null&&k!=""){s=RecResource.prototype.GetSCPDInfoDiv(k,c,a)}}if(typeof json_result.CAPJ!="undefined"){var l=json_result.CAPJ;var r=l[0];if(r!=null&&r!=""){o=RecResource.prototype.GetCAPJInfoDiv(r,c,a)}}var q=t+u+n+w+s+o;if(q!=""){var v="<div id='recInfoTitle' class='wx_jsframe_jiao wx_jsframe_jiaoBlank'><strong>相关资源</strong></div><div>"+q+"</div>";if(self==top){space3.pushSpace(a,v)}else{parent.space3.pushSpace(a,v)}e(v)}})}function e(k){if(b==0){$("#"+j).before(k)}else{if(b==1){$("#"+j).after(k)}else{$("#"+j).html(k)}}}};if(self==top){if(!this.space3){this.space3=CreateCacheSpace(20,0)}}RecResource.prototype.GetRecWWJD2ID=function(a,b,c,f){if(a==""){return}var d=$("#crrsPath").val();if(!d||d=="undefined"){d="http://kns.cnki.net/crrs"}var h=d+"/RelItems.ashx?keyword=";var l=h+encodeURI(a);var e="wwdb;wwjd;wwbd;sjes;ssjd;sjwd;stjd;sjwk;spqd;sjem;sjpd;sjcm;sipd;sjdu;sjup;scud;sjdg;sbed;sjgt;sjig;sjox;sjam;sjhp;sjhr;sjih;sjrs;sjsd;sard;sbad;scad;shjd;sjim;sapd;sesd;sijd;sjbc;sjce;sjco;sjdi;sjdj;sjdp;sjhd;sjif;sjiv;sjjs;sjms;sjre;sjsr;sjsu;sjsy;sjwa;sjwp;sswd;sjad;sjea;sjet;smud;sjtt;sjfs;sjng;ssbd;sbcd;sbce;sbdg;sbin;sbwp;sibd;stbd;sbws;sjbd;sbes;sbig;smbd;shad";var m=parent.$("#singleDB").val().toLocaleLowerCase();if(!m){return}var j=e.indexOf(m)>-1?"SCDB":"WWJD";l=l+"&productcode="+j;parent.$("#wwjdinfodiv").remove();parent.$("#scdbinfodiv").remove();var k;if(self==top){k=space3.getExData(a+j)}else{k=parent.space3.getExData(a+j)}if(k){g(k)}else{RequestJsonObject(l,function(){if(typeof json_result=="undefined"){return""}var w="";var s="";if(typeof json_result.WWJD!="undefined"){var y="<div id='wwjdinfodiv' style='word-break: break-all; display:none;' class='infoboxHor'>";var A="</div>";var x="";var r="";var q=false;if(c){x="<a class='more' onclick=\"MoreInfoSearch('WWDB','"+a+"');\"  href='javascript:void(0);' >在外文文献中检索<span>"+a+"</span><em style='font-family:宋体;font-style:normal;'>&gt;&gt;</em></a>"}var o=json_result.WWJD;for(i=0;i<o.length;i++){var z=o[i];if(z!=null&&z!=""){if(i%2==0){q=false}else{q=true}r+=RecResource.prototype.GetWWJDInfoTable(z,c,q)}}if(r!=""){w=y+"<table class='infoboxHor'>"+r+"<tr><td colspan='5'>"+x+"</td></tr></table>"+A}}if(typeof json_result.SCDB!="undefined"){var n="<div id='scdbinfodiv' style='word-break: break-all; display:none;' class='infoboxHor'>";var t="</div>";var x="";var p="";var q=false;if(c){x="<a class='more' onclick=\"MoreInfoSearch('SCDB','"+a+"');\" href='javascript:void(0);' >在中文文献中检索<span>"+a+"</span><em style='font-family:宋体;font-style:normal;'>>></em></a>"}var o=json_result.SCDB;for(i=0;i<o.length;i++){var u=o[i];if(u!=null&&u!=""){if(i%2==0){q=false}else{q=true}p+=RecResource.prototype.GetSCDBInfoTable(u,c,q)}}if(p!=""){s=n+"<table class='infoboxHor'>"+p+"<tr><td colspan='5'>"+x+"</td></tr></table>"+t}}var v=w+s;if(v!=""){if(self==top){space3.pushSpace(a+j,v)}else{parent.space3.pushSpace(a+j,v)}g(v);SetFrameHeight()}})}function g(n){if(b==0){parent.$("#"+f).before(n)}else{if(b==1){parent.$("#"+f).after(n)}else{parent.$("#"+f).html(n)}}InsertRecResource()}};function InsertRecResource(){var a=parent.$("#singleDB").val();if(a.length==0){a="SCDB"}var b="WWDB;WWJD;WWBD;SJES;SSJD;SJWD;STJD;SJWK;SPQD;SJEM;SJPD;SJCM;SIPD;SJDU;SJUP;SCUD;SJDG;SBED;SJGT;SJIG;SJOX;SJAM;SJHP;SJHR;SJIH;SJRS;SJSD;SARD;SBAD;SCAD;SHJD;SJIM;SAPD;SESD;SIJD;SJBC;SJCE;SJCO;SJDI;SJDJ;SJDP;SJHD;SJIF;SJIV;SJJS;SJMS;SJRE;SJSR;SJSU;SJSY;SJWA;SJWP;SSWD;SJAD;SJEA;SJET;SMUD;SJTT;SJFS;SJNG;SSBD;SBCD;SBCE;SBDG;SBIN;SBWP;SIBD;STBD;SBWS;SJBD;SBES;SBIG;SMBD;SHAD";if(document.URL.toLocaleLowerCase().indexOf("turnpage")<0){if(parent.$("#wwjdinfodiv").html()!=null&&b.indexOf(a)<0){$(".GridTableContent").parent("td").parent("tr").after("<tr id='testTR'><td>"+parent.$("#wwjdinfodiv").html()+"</td></tr>")}if(parent.$("#scdbinfodiv").html()!=null&&b.indexOf(a)>=0){$(".GridTableContent").parent("td").parent("tr").after("<tr id='testTR'><td>"+parent.$("#scdbinfodiv").html()+"<script>setScdbAuAndJn();</script></td></tr>")}}}function MoreInfoSearch(d,e){var c="../RedirectPage.aspx?action=indexpage&code={0}&kw={1}&korder=0";var b=d;if(b=="CRFD"){b="CRPD"}if(b=="IMG"){b="IMAGE"}if(b=="CLKL"){b="CLKD"}if(b=="SCSD"){b="CISD"}if(b=="SCPD"){b="SCOD"}var a=encodeURIComponent(e);c=c.replace("{0}",b).replace("{1}",a);if(a!=""){window.open(c)}}function WriteLog(a){CommonDealNoDiv("CRRS&","../request/SearchHandler.ashx","ua="+a,null,null)}function RemoveRecDiv(){$("#recInfoTitle").remove();$("#crfdinfodiv").remove();$("#imginfodiv").remove();$("#scsdinfodiv").remove();$("#scpdinfodiv").remove();$("#clklinfodiv").remove();$("#capjinfodiv").remove()}function GetFlagTI(a){if(a==""||a=="null"||a==null){return""}else{a=a.replace(/\$@\#/g,'<font class="Mark">');a=a.replace(/\#@\$/g,"</font>");return a}}function GetFlagAU(a){if(a==""||a=="null"||a==null){return""}else{a=a.replace(/\;;/g,"; ");if(a.length>60){a=a.substring(0,60)+"..."}return a}}; 
 function _getXmlHttp(){
/*@cc_on @*/
/*@if (@_jscript_version >= 5)
	var progids=["Msxml2.XMLHTTP", "Microsoft.XMLHTTP"]
	for (i in progids) {
		try { return new ActiveXObject(progids[i]) }
		catch (e) {}
	}
@end @*/
try{return new XMLHttpRequest()}catch(e2){return null}}function CachedResponse(a){this.readyState=ReadyState.Complete;this.status=HttpStatus.OK;this.responseText=a}ReadyState={Uninitialized:0,Loading:1,Loaded:2,Interactive:3,Complete:4};HttpStatus={OK:200,NotFound:404};function Request_from_cache(c,b){var a=this._cache[c];if(a!=null){var d=new CachedResponse(a);b(d);return true}else{return false}}function Request_cached_get(b,a){if(!this.FromCache(b,a)){var c=this;this.Get(b,function(d){if((d.readyState==ReadyState.Complete)&&(d.status==HttpStatus.OK)){c._cache[b]=d.responseText}a(d)},"GET")}}function Request_get(c,b,a){if(!this._get){return}if(a==null){a="GET"}if(this._get.readyState!=ReadyState.Uninitialized){this._get.abort()}if(a&&a=="POST"){var d=c.split("?");if(d){this._get.open(a,d[0],true)}else{this._get.open(a,c,true)}this._get.setRequestHeader("Content-Type","application/x-www-form-urlencoded");if(b!=null){var e=this._get;this._get.onreadystatechange=function(){b(e)}}if(d){this._get.send(d[1])}else{this._get.send(c)}}else{this._get.open(a,c,true);if(b!=null){var e=this._get;this._get.onreadystatechange=function(){b(e)}}this._get.send(null)}}function Request_get_no_cache(d,c,a){if(getByteLen(d)>2083){a="POST"}var e=(-1<d.indexOf("?"))?"&":"?";var b=d+e+"__="+encodeURIComponent((new Date()).toString());return this.Get(b,c,a)}function getByteLen(e){var b=0;for(var d=0;d<e.length;d++){var c=e.charAt(d);if(c.match(/[^\x00-\xff]/ig)!=null){b+=2}else{b+=1}}return b}function Request(){this.Get=Request_get;this.GetNoCache=Request_get_no_cache;this.CachedGet=Request_cached_get;this.FromCache=Request_from_cache;this.Use=function(){return this._get!=null};this.Cancel=function(){if(this._get){this._get.abort()}};this._cache=new Object();this._get=_getXmlHttp();if(this._get==null){return}}var waitDiv;var waitElement;var scrollX,scrollY=-1;function MoveWaitElement(d){var c,a;if(!waitElement){CreateWaitElement()}if(window.pageYOffset&&typeof(window.pageYOffset)=="number"){c=window.pageYOffset;a=window.pageXOffset}else{if(document.body&&document.documentElement&&document.documentElement.scrollTop){c=document.documentElement.scrollTop;a=document.body.scrollLeft}else{if(document.body&&typeof(document.body.scrollTop)=="number"){c=document.body.scrollTop;a=document.body.scrollLeft}}}if(scrollX!=a||scrollY!=c){scrollX=a;scrollY=c;if(d=="center"){var b=document.body.clientWidth;waitElement.style.top=280+document.documentElement.scrollTop+"px";waitElement.style.left=(document.body.offsetWidth-200)/2+"px"}else{waitElement.style.top=c+"px";waitElement.style.right=-a+"px"}}}function CreateWaitElement(){var a=document.getElementById("Ajax__Waiting");if(!a){a=document.createElement("div");a.id="Ajax__Waiting";a.style.position="absolute";a.style.height=16;a.style.width=150;a.style.paddingLeft="3px";a.style.paddingRight="3px";a.style.fontSize="10px";a.style.fontFamily="Arial, Verdana, Tahoma";a.style.border="#000000 1px solid";a.style.backgroundColor="#000000";a.style.color="#ffffff";a.innerHTML="<img src=../images/"+LanguageEncode+"/loading.gif  width=16 height=16 border=0 align=absMiddle> "+message.searchingLoad;a.style.visibility="hidden";document.body.insertBefore(a,document.body.firstChild)}waitElement=a}function MovewaitDiv(d){var c,a;if(!waitDiv){CreatewaitDiv()}if(document.all){if(window.pageYOffset&&typeof(window.pageYOffset)=="number"){c=window.pageYOffset;a=window.pageXOffset}else{if(document.body&&document.documentElement&&document.documentElement.scrollTop){c=document.documentElement.scrollTop;a=document.body.scrollLeft}else{if(document.body&&typeof(document.body.scrollTop)=="number"){c=document.body.scrollTop;a=document.body.scrollLeft}}}}if(scrollX!=a||scrollY!=c){scrollX=a;scrollY=c;if(d=="center"){var b=document.body.clientWidth;waitDiv.style.top=280+document.documentElement.scrollTop+"px";waitDiv.style.left=(document.body.offsetWidth)/2-8+"px"}else{waitDiv.style.top=c+"px";waitDiv.style.right=-a+"px"}}}function CreatewaitDiv(a){var b=document.getElementById("Search__Waiting");if(!b){b=document.createElement("div");b.id="Search__Waiting";b.style.position="absolute";b.style.height=20;b.style.width=180;b.style.paddingLeft="3px";b.style.paddingRight="3px";b.style.fontSize="12px";b.style.fontFamily="Arial, Verdana, Tahoma";b.style.backgroundColor="";b.style.color="#ffffff";b.style.zIndex=300;b.innerHTML="<img src=../images/"+LanguageEncode+"/loading.gif  width=30 height=30 border=0 align=absMiddle><b> "+a+"</b>";b.style.display="none";document.body.insertBefore(b,document.body.firstChild)}waitDiv=b}function HideWaitDiv(){if(waitDiv){if(waitDiv.style.display==""){waitDiv.style.display="none"}}if(typeof ispost!="undefined"){if(ispost){ispost=false}}}function ShowWaitDiv(){if(waitDiv){waitDiv.style.display="";MovewaitDiv("center")}setTimeout("HideWaitDiv()",15000)}function CommonDeal(b,f,i,a,c,e){CreatewaitDiv(c);if(waitDiv){if(c!=null&&c!=""){var g=document.getElementById("divsearchtip");if(g){g.innerHTML=c}ShowWaitDiv()}}var h=new Request();var d=f+"?action="+b+i;h.GetNoCache(d,a,e)}function CommonDealNoDiv(b,f,h,a,c,e){var g=new Request();var d=f+"?action="+b+h;g.GetNoCache(d,a,e)}var ajaxSubmit={special:"more.aspx",Submit:function(c,a,f,d,e,b){if(!b){b="POST"}if(!e){e="text"}if(a){a.random=Math.random()}$.ajax({type:b,contentType:"application/x-www-form-urlencoded",url:c,data:a,beforeSend:function(h){if(!d||d==""){return}var i=$(window).height();var k=$(document).scrollTop();var g=(i-300)/2+k;var j=$(d).width()/2;if(c.indexOf(ajaxSubmit.special)>-1){$(d).append("<tr class='delete'><td colspan='10'><div class='loading' style='text-align_center;margin-left:"+(j-106)+"px;text-align:right'>正在加载下一页...</div></td></tr>")}else{$(d).append("<div class='loading' style='text-align_center;margin-left:"+(j-16)+"px'></div>")}},complete:function(g){},dataType:e,error:function(){$(d+" .loading").remove();$(d+" .delete").remove()},success:function(g){$(d+" .loading").remove();$(d+" .delete").remove();if(f){f(g)}else{if(!g){return""}}}})}}; 
 function addToCookie(b,a){company="cnki";cookie=new String(getCookie("RecordID"));if((cookie.length>0)&&((cookie.substring(0,cookie.indexOf(":"))==company))){if(cookie.length-1==cookie.indexOf(":")){setCookie("RecordID",cookie+b,a)}else{setCookie("RecordID",cookie+","+b,a)}}else{setCookie("RecordID",company+":"+b,a)}}function setCookie(a,c,b){if(window.localStorage){if(c&&c!=""){if(b==2||b=="2"){sessionStorage.setItem(a,c)}else{localStorage.setItem(a,c)}}}else{document.cookie=a+"="+escape(c)+";path=/"}}function getValueFromCookie(d){var e=d+"=";var h=false;var g=0;var c=0;var b=document.cookie;var f="";var a=0;while(a<b.length){g=a;c=g+e.length;if(b.substring(g,c)==e){h=true;break}a++}if(h==true){g=c;c=b.indexOf(";",g);if(c<g){c=b.length}f=unescape(b.substring(g,c))}if(f.indexOf("cnki:")==0){f=f.substring(5,f.length)}return f}; 
 function HistoryOperat(){this.IshaveNewSeeCookie=0;this.IshaveNewDownCookie=0}HistoryOperat.prototype.IsSupHTML5=(function(){return window.localStorage?true:false});HistoryOperat.prototype.newsetCookie=function(b,e){if(e=="输入检索词"){return}var d=7;var a=new Date();a.setTime(a.getTime()+d*24*60*60*1000);var c="";if(this.newgetCookie(b)!=null){c=this.newgetCookie(b)}if(c!=null&&c!=""&&c!="<#>"){if(!this.IsIndexOfTheValue(c,$.trim(e))){if(this.IsSupHTML5()){localStorage.setItem(b,e+"<#>"+c)}else{document.cookie=b+"="+escape(e+"<#>"+c)+";expires="+a.toGMTString()+";path=/"}}}else{if(this.IsSupHTML5()){localStorage.setItem(b,e+"<#>")}else{document.cookie=b+"="+escape(e+"<#>")+";expires="+a.toGMTString()+";path=/"}}this.setCookieNew15(b)};HistoryOperat.prototype.setCookieNew15=function(b){var f=7;var a=new Date();a.setTime(a.getTime()+f*24*60*60*1000);var d="";var e=this.newgetCookie(b);var c=e.split("<#>");if(c.length>15){for(i=0;i<=15;i++){d+=c[i]+"<#>"}if(this.IsSupHTML5()){localStorage.setItem(b,d)}else{document.cookie=b+"="+escape(d)+";expires="+a.toGMTString()+";path=/"}}};HistoryOperat.prototype.IsIndexOfTheValue=function(d,a){var e=false;var f="";var c=d.split("<#>");for(var b=0;b<c.length;b++){if(c[b].toString()==a){e=true}}return e};HistoryOperat.prototype.newgetCookie=function(a){var d="";if(this.IsSupHTML5()){d=localStorage.getItem(a)}else{var b,c=new RegExp("(^| )"+a+"=([^;]*)(;|$)");if(b=document.cookie.match(c)){d=unescape(b[2])}}if(d==null){d=""}return d};HistoryOperat.prototype.newdelCookie=function(b,c){if(this.IsSupHTML5()){localStorage.removeItem(b)}else{var a=new Date();a.setTime(a.getTime()-1);var d=getCookie(b);if(d!=null){document.cookie=b+"=| ;expires="+a.toGMTString()+";path=/"}}$("#"+c).html("");if(b.indexOf("UserInputs")>-1){$("#history_js").hide();$("#newsearchhis").hide();this.hisresult_ForInputs()}else{if(b=="UserSees"){$("#history_ll").hide();$("#newsearchhis1").hide()}else{if(b=="UserDownLoads"){$("#history_xz").hide();$("#newsearchhis2").hide()}}}};HistoryOperat.prototype.hisresult_SeeAndDown=function(){var b;var c=this.newgetCookie("UserSees");var d=this.newgetCookie("UserDownLoads");if(this.IsSupHTML5()){this.getHisResultByLocStog("UserSees",c,"listSpan1","newsearchhis1","history_ll");this.getHisResultByLocStog("UserDownLoads",d,"listSpan2","newsearchhis2","history_xz")}else{c=c.replace(/</g,"&lt");c=c.replace(/>/g,"&gt");d=d.replace(/</g,"&lt");d=d.replace(/>/g,"&gt");var a="&UserSees="+escape(c)+"&UserDownLoads="+escape(d);$.getJSON("../request/GetUserHistory.ashx",a,function(e){if(e){if(e.UserSees&&e.UserSees.indexOf("clearspan")>-1){$("#newsearchhis1").html(unescape(e.UserSees));$("#history_ll").show();$("#newsearchhis1").show()}if(e.UserDownLoads&&e.UserDownLoads.indexOf("clearspan")>-1){$("#newsearchhis2").html(unescape(e.UserDownLoads));SetDisplayValue("history_xz","");SetDisplayValue("newsearchhis2","")}}})}};HistoryOperat.prototype.hisresult_ForSeeAndDown=function(b,e){var a="&"+b+"="+this.newgetCookie(b);var c=e;var d=function(g){if(g.readyState!=ReadyState.Complete){return}if(g.status==HttpStatus.OK){if(g.responseText!=""&&g.responseText.indexOf("clearspan")>-1){if(g.responseText.indexOf("UserSees")>-1){$("#newsearchhis1").html(g.responseText);$("#history_ll").show();$("#newsearchhis1").show();if(c){$("#cookichistory1").show();var f=$("#s_jiantoull").attr("src");var h=f.replace("s_jiantou01","s_jiantou");$("#s_jiantoull").attr("src",h)}}else{if(ge("newsearchhis2")!=null){ge("newsearchhis2").innerHTML=g.responseText;SetDisplayValue("history_xz","");SetDisplayValue("newsearchhis2","");if(c){$("#cookichistory2").show();var f=$("#s_jiantoudown").attr("src");var h=f.replace("s_jiantou01","s_jiantou");$("#s_jiantoudown").attr("src",h)}}}}}};if(b=="UserSees"){CommonDealNoDiv(b+"&","../request/GetUserSeesHandler.ashx",a,d,null,"GET")}else{if(b=="UserDownLoads"){CommonDealNoDiv(b+"&","../request/GetUserDownLoadsHandler.ashx",a,d,null,"GET")}}};HistoryOperat.prototype.hisresult_ForInputs=function(){CommonDealNoDiv("UserInputs&","../request/GetUserInputsHandler.ashx",null,null,null,"GET")};HistoryOperat.prototype.hisresult_new=function(r,s,k,q){var c;var u;if(r&&r.indexOf("UserInputs")>-1){u=this.newgetCookie(r)}var m=0;if(u!=null&&u.length>1){c="<ul class='listSpan'>";var f="";var b="";var n=u.split("<#>");var a=0;for(var g=0,j=n.length-1;g<j;g++){if(!n[g]){continue}var v="";var d=n[g];if(n[g].length>30){d=n[g].substring(0,30)+"..."}if(r=="UserInputsN"){v="<li><a onclick=\"InSearchSimilar('"+n[g]+"','his')\"  href='javascript:void(0)'>"+d+"</a></li>"}else{v="<li><a onclick=\"SearchSimilar('"+n[g]+"','his')\"  href='javascript:void(0)'>"+d+"</a></li>"}if(a<5){c+=v}else{if(a<15){f+=v}}a++}c+="</ul>";if(f!=""){c+="<ul class='listSpan' id='"+s+"' style='display:none'>"+f+"</ul>"}if(a>0){var h="<a onclick=\"historyoperater.newdelCookie('"+r+"','"+k+"');\"  href='javascript:void(0)'>清空</a>";var o="<a href='../brief/history.aspx' target='_blank'>检索痕迹</a>";if(r=="UserInputs"){c+='<p class="clearspan">'+o+"&nbsp;&nbsp;&nbsp;&nbsp;"+h+"</p>"}else{c+='<p class="clearspan">'+h+"</p>"}}if(ge(k)!=null){ge(k).innerHTML=c;SetDisplayValue(q,"");SetDisplayValue(k,"");try{var t=ge(q);if(t&&$(t).find("a").length>0){$(t).find("a").removeClass().addClass("arrowShow")}}catch(p){}}}};HistoryOperat.prototype.getHisResultByLocStog=function(o,g,m,c,n){var d;if(g!=null&&g.length>1){d="<ul class='listSpan'>";var e="";var b=g.split("<#>");var f=0;var p;for(var a=0,j=b.length-1;a<j;a++){if(!b[a]){continue}p=b[a].split("<!>");if(p.length!=3){continue}if(!p[2]||!p[1]){continue}var h="<li><a target='_blank' href='"+p[2]+"'>"+p[1]+"</a></li>";if(f<5){d+=h}else{if(f<15){e+=h}}f++}d+="</ul>";if(e!=""){d+="<ul class='listSpan' id='"+m+"' style='display:none'>"+e+"</ul>"}if(f>0){var k="<a onclick=\"historyoperater.newdelCookie('"+o+"','"+c+"');\"  href='javascript:void(0)'>清空</a>";d+='<p class="clearspan">'+k+"</p>"}if(ge(c)!=null){ge(c).innerHTML=d;SetDisplayValue(n,"");SetDisplayValue(c,"")}}};HistoryOperat.prototype.getCookieParams=function(c){var e="";if(c&&c.length>0){var b="";var f="";var a="";var d=decodeURI(c);b=this.getValueFromQuery(d,"dbcode");f=this.getValueFromQuery(d,"dbname");a=this.getValueFromQuery(d,"filename");if(a==""){a=this.getValueFromQuery(d,"file")}if(a==""){a=this.getValueFromQuery(d,"recid")}e=a+"!"+b+"!"+f}return e};HistoryOperat.prototype.getValueFromQuery=function(c,b){var a="";if(Object.prototype.toString.call(c)=="[object String]"&&c.length>0&&Object.prototype.toString.call(b)=="[object String]"&&b.length>0){var d=new RegExp("[?&]"+b+"=([^&]+)","ig");if(d.test(c)){a=RegExp.$1}}return a};HistoryOperat.prototype.getCookieParams_Sees=function(c){if(!c||!c.href){return""}var b=this.getCookieParams(c.href);if(this.IsSupHTML5()){var a=(c.innerText&&c.innerText!=undefined)?c.innerText:c.text;b=b+"<!>"+a+"<!>"+c.href}return b};HistoryOperat.prototype.getCookieParams_DownsL=function(g){var e="";var d;if(window.attachEvent){d=g.parentNode.parentNode.parentNode}else{d=g.parentNode}var c=getElementsByClassName("fz14","a",d,true)[0];if(c){e=this.getCookieParams(c.href);if(this.IsSupHTML5()){var f=(c.innerText&&c.innerText!=undefined)?c.innerText:c.text;e=e+"<!>"+f+"<!>"+c.href}}return e};HistoryOperat.prototype.getCookieParams_DownsD=function(h){var e="";var d=h.parentNode.parentNode.parentNode.parentNode;var g=getElementsByClassName("GridTitleDiv","div",d,true)[0];if(typeof g=="undefined"){return}var c=$(g).children().find("a");if(c){for(var f=0;f<c.length;f++){var a=c[f].href;a=a.toLowerCase();if(a.indexOf("filename")>0||a.indexOf("file")>0){e=this.getCookieParams(a);continue}}if(this.IsSupHTML5()){e=e+"<!>"+c.text()+"<!>"+c.attr("href")}}return e};HistoryOperat.prototype.IsContinsTheValue=function(b,d){var a=this.newgetCookie(b);var c=false;if(a){if(a.indexOf(d)>-1){c=true}}return c};HistoryOperat.prototype.IsIndexOfTheValueForDown=function(f,e){var g=this.newgetCookie(f);var d=false;var j="";if(g!=null){for(var a=0;a<g.length;a++){if(g[a]!="|"){j+=g[a]}else{var c=/\<script .*\<\/script\>/ig;var b=/\<font .*\<\/font\>/ig;var h=e.replace(c,"");h=h.replace(b,"");if(j.indexOf(h)>-1){d=true;return d}j=""}}}return d}; 
 function TPI_openwindow(o,k,g,e){var c=(document.all)?window.event.y+98:0;var d=(document.all)?window.event.x:0;arrFrame=parent?parent.document.getElementsByTagName("iframe"):null;if(arrFrame){for(var a=0;a<arrFrame.length;a++){if(arrFrame[a].contentWindow.document==document){var m=arrFrame[a];while(m){d+=m.offsetLeft;c+=m.offsetTop;m=m.offsetParent}d-=new Number(parent.document.body.scrollLeft+parent.document.documentElement.scrollLeft);c-=new Number(parent.document.body.scrollTop+parent.document.documentElement.scrollTop);var f=(document.all)?window.event.srcElement:e.target;c+=document.all&&f?f.offsetHeight>0?f.offsetHeight:offsetHeight.clientHeight:0;break}}}var j=screen.width;var l=screen.height;var n=j-400;var p=l-340;if(d>=n){d=n}if(c>=p){c=p}g=g.toLowerCase();var h=false;if(g.indexOf("left=")==-1){h=true;g+=",left="+d}if(g.indexOf("top=")==-1){h=true;g+=",top="+c}var b=OpenWindow(o)}; 
 function SetDisplayModelCookie(b){var c=GetQueryStringByName(window.location.href,"dbPrefix");b+="@"+c;var d=30;var a=new Date();a.setTime(a.getTime()+d*24*60*60*1000);document.cookie="KNS_DisplayModel="+escape(b)+";expires="+a.toGMTString()+";path=/"}function DisplayModeRadioBLOnChange(c){var a=c;var d=window.location.href;d=SetQueryStringByName(d,"DisplayMode",a);SetDisplayModelCookie(a);if(document.forms[0].curpage){a=document.forms[0].curpage.value;d=SetQueryStringByName(d,"curpage",a)}if(document.forms[0].QueryID){a=document.forms[0].QueryID.value;d=SetQueryStringByName(d,"QueryID",a)}if(document.forms[0].turnpage){a="1";d=SetQueryStringByName(d,"turnpage",a)}var b=(parent&&parent.GetResultFrame)?parent.GetResultFrame():null;if(b){b.src=d}else{window.location=d}}function Init(){try{SetFrameHeight()}catch(a){}try{window.parent.ShorFirstPage()}catch(a){}}var briefOnLoadFun=function(){};function GetTxtValue(){var a=$("#txt_1_value1",window.parent.document).attr("value");$("#HiddenField1").attr("value",a)}function BriefOnload(){SetFrameHeight();GetRecommend();if(typeof briefOnLoadFun=="function"){briefOnLoadFun()}trunPageSetPositon();window.parent.HideWaitDiv();BindOnClick();BindOnClick_DownLoad();if(IsExecutGroup()){BriefExpandGroup()}$("td:first",$(".GTContentTitle")).attr("align","left")}function ShowHeat(){if($("#heatjson").attr("value")!=""){}else{GetHeat()}}function GetHeat(){var a="";a+="filenameStr=";$("input[name='FileNameS']").each(function(){a+=$(this).attr("value");a+="|";var b=$(this).attr("value");var c=b.split("!");$(this).parent().parent().attr("name",c[1])});a=a.substring(0,a.length-1);$.ajax({url:$("#kredisServerPath").val()+"/KRedis/ReadArtHeatHandler.ashx",type:"get",dataType:"jsonp",jsonp:"jsoncallback",data:a,timeout:5000,beforeSend:function(){},success:function(b){var d=O2String(b);$("#heatjson").attr("value",d);var c=0;$("input[name='FileNameS']").each(function(){var f=b[0][$(this).parent().parent().attr("name")];var g=$(this).parent().parent().find("td:last").find(".hotspot:first");g.find("span").attr("value",f);g.attr("title","热点关注度："+parseInt(f*100)/10+"(最近下载、浏览的数量值)");g.find("span").text(parseInt(f*100)/10);g.find("span").css("width",f*100+"%")});$(".GridSingleRow").each(function(){var g=b[0][$(this).attr("name")];var f=$(this).find(".GridRightColumn:first").find(".GridContentDiv:first").find(".fenxiang:first").find(".hotspot:first");f.find("span").attr("value",g);f.attr("title","热点关注度："+parseInt(g*100)/10+"(最近下载、浏览的数量值)");f.find("span").text(parseInt(g*100)/10);f.find("span").css("width",g*100+"%")});$(".GridDoubleRow").each(function(){var g=b[0][$(this).attr("name")];var f=$(this).find(".GridRightColumn:first").find(".GridContentDiv:first").find(".fenxiang:first").find(".hotspot:first");f.find("span").attr("value",g);f.attr("title","热点关注度："+parseInt(g*100)/10+"(最近下载、浏览的数量值)");f.find("span").text(parseInt(g*100)/10);f.find("span").css("width",g*100+"%")})},complete:function(c,b){},error:function(b){}})}var O2String=function(b){var a=[];var d="";if(Object.prototype.toString.apply(b)==="[object Array]"){for(var c=0;c<b.length;c++){a.push(O2String(b[c]))}d="["+a.join(",")+"]"}else{if(Object.prototype.toString.apply(b)==="[object Date]"){d="new Date("+b.getTime()+")"}else{if(Object.prototype.toString.apply(b)==="[object RegExp]"||Object.prototype.toString.apply(b)==="[object Function]"){d=b.toString()}else{if(Object.prototype.toString.apply(b)==="[object Object]"){for(var c in b){b[c]=typeof(b[c])=="string"?'"'+b[c]+'"':(typeof(b[c])==="object"?O2String(b[c]):b[c]);a.push(c+":"+b[c])}d="{"+a.join(",")+"}"}}}}return d};function ShowHistory(){SetFrameHeight();window.parent.HideWaitDiv()}function BriefExpandOnLoad(){ShowHistory();var a=parent.document.getElementById("resultFilter");if(a){a.style.display="none"}}function BriefExpandGroup(){var a=GetQueryStringByName(window.location.href,"dbPrefix");if(parent.leftGroupCallBackFun&&parent.isBaiKeClass(a)){if(typeof parent.leftGroupCallBackFun!="undefined"){try{parent.leftGroupCallBackFun()}catch(b){}}}}function IsExecutGroup(){var a=true;a=isEmptyQueryParam("sorttype");if(a){a=isEmptyQueryParam("ctl");if(a){a=isEmptyQueryParam("param");if(a){a=isEmptyQueryParam("curpage");if(a){a=isEmptyQueryParam("RecordsPerPage")}}}}return a}function isEmptyQueryParam(b){var c=true;var a=GetQueryStringByName(window.location.search,b);if(a&&a.length>0){c=false}return c}function trunPageSetPositon(){var d=GetQueryStringByName(window.location.href,"turnpage");var c=d&&d.length>0?true:false;if(c){try{var b=parent.ge("resultFilter");setPosition(b)}catch(a){}}}function maoFun(b){var a=ge(b);setPosition(a)}function setPosition(a){if(a){a.scrollIntoView(true)}}function BackTop(){if(parent.backToTopFun){if(typeof parent.backToTopFun!="undefined"){try{parent.backToTopFun()}catch(a){}}}}function GetImgPath(c,b,a){if(window.ImgSearchFC){var d="";if(b){d=window.ImgSearchFC+GetCSYDImgSrc(c,a);SetImgSrc(c,d)}else{d=window.ImgSearchFC+"/getimage.ashx?id="+encodeURIComponent(c);SetImgSrc(c,d)}}}function GetCSYDImgSrc(c,b){var a="";if(b.length>5){a=b.substring(4,5)}if(a==""){return""}return"/"+a+"/"+b+"/"+c+".jpg"}function SetImgSrc(b,c){var a=document.getElementById("img"+b);if(a&&c&&c!=""){a.src=c}}var isLogin=false;function SetMark(){isLogin=true}function goTop(l,m){l=l||0.1;m=m||16;var c=0;var n=0;var f=0;var g=0;var k=0;var b=0;if(document.documentElement){c=document.documentElement.scrollLeft||0;n=document.documentElement.scrollTop||0}if(document.body){f=document.body.scrollLeft||0;g=document.body.scrollTop||0}var k=window.scrollX||0;var b=window.scrollY||0;var d=Math.max(c,Math.max(f,k));var a=Math.max(n,Math.max(g,b));var h=1+l;window.scrollTo(Math.floor(d/h),Math.floor(a/h));if(d>0||a>0){var j="goTop("+l+", "+m+")";window.setTimeout(j,m)}}function grabEvent(b){var a=new DirectTurn(b);a.directTurnPage();return false}function DirectTurn(a){this.curOpe=-1;this.curDOC=document.getElementById("iframeResult");if(!this.curDOC){this.curDOC=document}else{this.curDOC=this.curDOC.contentWindow.document}this.event=a}DirectTurn.prototype.isTurnPage=function(){var f=this.event.srcElement?this.event.srcElement:this.event.target;var b=f.tagName;var d=/input|select/gi;if(d.test(b)){return false}else{var c=f.type;var a=/text/gi;if(a.test(c)){return false}}return true};DirectTurn.prototype.directTurnPage=function(){if(!this.isTurnPage()){return}this.curOpe=this.getCurOpe();if(this.curOpe!=3&&this.curOpe!=4){return}var a="";switch(this.curOpe){case 3:a=this.getRedirectUrl("Page_prev");break;case 4:a=this.getRedirectUrl("Page_next");break;default:this.isTurn=false;break}this.excutTurn(a)};DirectTurn.prototype.excutTurn=function(b){var a=b;if(a&&a!=""){this.trunAssignment(a);DoParentFunc("ShowWaitDiv")}};DirectTurn.prototype.trunAssignment=function(b){if(b&&b!=""){var a=document.getElementById("iframeResult");if(a){a.src=b}else{window.location=b}}};DirectTurn.prototype.getCurOpe=function(){var a=this.event.which||this.event.keyCode;switch(a){case 37:case 3:case 271:return 3;case 39:case 4:case 272:return 4}return 1};DirectTurn.prototype.getRedirectUrl=function(b){var a=function(f,g){try{return f.getElementById(g)}catch(d){return null}};var c=a(this.curDOC,b);if(c&&c.href){return c.href}return""};var SetDownloadImg;function ChangeDownloadImg(){if($("#LoginState").val()=="-1"){return}var a=new DownloadImg();SetDownloadImg=function(b){a.setDownloadImg(b)};a.changeByRightJson()}function DownloadImg(){this.JsonArr=null;this.rows=null}DownloadImg.prototype.changeByRightJson=function(){this.rows=GetGridRow();if(typeof this.rows=="undefined"||this.rows.length==0){return}var col=this.getLinkCol(this.rows[0]);var queryID=this.getQueryID(col);var curRec=this.getCurRec(col);var dbprefix=GetQueryStringByName(window.location.href,"dbprefix");if(dbprefix==undefined){dbprefix=""}if(queryID&&queryID.length>0&&curRec&&curRec.length>0){var url="../request/RightValid.ashx?q="+queryID+"&c="+curRec+"&l="+this.rows.length+"&dbprefix="+dbprefix;var request=new Request();request.GetNoCache(url,function(result){if(result.readyState!=ReadyState.Complete){return}if(result.status==HttpStatus.OK&&result.responseText!=""){var jsonArr=eval("("+result.responseText+")");if(typeof SetDownloadImg!="undefined"){try{SetDownloadImg(jsonArr)}catch(e){}}}})}};DownloadImg.prototype.setDownloadImg=function(c){if(typeof this.rows=="undefined"||this.rows.length==0){return}if(c==null){return}var b=true;for(var f=0;f<this.rows.length;f++){var d=this.getLinkCol(this.rows[f]);var a=this.getCurRec(d);if(b){var h=this.getDownImg(this.rows[f]);if(h){this.changeImg(h,c[a],false)}else{b=false}}if(!b){b=false;var g=this.getDownAEle(this.rows[f]);if(g){this.changeImg(g,c[a],true)}}}};DownloadImg.prototype.changeImg=function(c,b,a){if(a){this.setClassState(c,b)}else{this.setImgState(c,b)}};DownloadImg.prototype.setClassState=function(c,b){if(c){var a=c.className;var d=c.title;switch(b[0]){case"1":a="briefDl_Y";break;case"0":case"-1":a="briefDl_N";d=b[1];break}c.className=a;c.title=d}};DownloadImg.prototype.setImgState=function(c,d){if(c){var a=c.src;var b=c.title;switch(d[0]){case"1":a=a.substring(0,a.lastIndexOf("/"));a+="/download.gif";break;case"0":case"-1":a=a.substring(0,a.lastIndexOf("/"));a+="/download_cannot.gif";b=d[1];break}c.src=a;c.title=b}};DownloadImg.prototype.getLinkCol=function(a){return this.getColByKey(a,"detail/detail.aspx")};DownloadImg.prototype.getDownImgCol=function(a){return this.getColByKey(a,"/download.aspx")};DownloadImg.prototype.getColByKey=function(d,a){var b=null;for(var c=0;c<d.childNodes.length;c++){b=d.childNodes[c];if(b&&b.innerHTML&&b.innerHTML.indexOf(a)>-1){break}}return b};DownloadImg.prototype.searchElement=function(b,d){var a=null;if(b){if(b.childNodes.length>0){var c=b.childNodes;for(var f=0;f<c.length;f++){if(a){break}if(c[f]){if(c[f].childNodes.length>0){a=this.searchElement(c[f],d)}else{if(d(c[f])){a=c[f];break}}}}}else{if(isImg(c[f])){a=c[f]}}}return a};DownloadImg.prototype.getDownAEle=function(b){var a=this.getDownImgCol(b);return this.searchElement(a,function(c){if(c&&(c.tagName=="A"||c.tagName=="a")&&c.href.indexOf("download.aspx")>0){return true}})};DownloadImg.prototype.getDownImg=function(d){var c=null;var b=this.getDownImgCol(d);var a=function(f){if(f){if(f.tagName=="IMG"){if(f.src.indexOf("download")>=0&&f.src.indexOf("download_eng")<0){return true}}}return false};return this.searchElement(b,a)};DownloadImg.prototype.getInnerHTML=function(b){var a="";if(b&&b.innerHTML){return b.innerHTML}return a};DownloadImg.prototype.getQueryID=function(a){var b=this.getInnerHTML(a);b=this.replaceFun(b,"&amp;","&");return GetQueryStringByName(b,"QueryID")};DownloadImg.prototype.getCurRec=function(a){var b=this.getInnerHTML(a);b=this.replaceFun(b,"&amp;","&");return GetQueryStringByName(b,"CurRec")};DownloadImg.prototype.replaceFun=function(c,a,b){var d=new RegExp(a,"gi");c=c.replace(d,b);return c};function addTitToCookic(d){var b=GetHistoryObj();var a=b.getCookieParams_Sees(d);if(typeof a=="undefined"){return}var c=a.split("!");if(!b.IsContinsTheValue("UserSees",c[0])){b.newsetCookie("UserSees",a);b.IshaveNewSeeCookie=1}WriteLog(c[1],c[0],"detail")}function addTitToCookic_DownLoad(d){var b=GetHistoryObj();var a=b.getCookieParams_DownsL(d);if(typeof a=="undefined"){return}var c=a.split("!");if(!b.IsContinsTheValue("UserDownLoads",c[0])){b.newsetCookie("UserDownLoads",a);b.IshaveNewDownCookie=1}WriteLog(c[1],c[0],"download")}function addTitToCookic_DownLoaddiv(d){var b=GetHistoryObj();var a=b.getCookieParams_DownsD(d);if(typeof a=="undefined"){return}var c=a.split("!");if(!b.IsContinsTheValue("UserDownLoads",c[0])){b.newsetCookie("UserDownLoads",a);b.IshaveNewDownCookie=1}WriteLog(c[1],c[0],"download")}function GetHistoryObj(){if(parent!=undefined&&parent.historyoperater!=null){return parent.historyoperater}return typeof HistoryOperat=="function"?new HistoryOperat():{}}function GetGridRow(){var b=getElementsByClassName("fz14","a");var d=getElementsByClassName("GridRightColumn","div");var a;if(b[0]){a=b}else{a=d}if(b&&b.length>0){for(var c=0;c<b.length;c++){a[c]=GetParent(b[c],"tr")}}return a}function GetParent(b,a){while(b.parentNode){if(b.parentNode.tagName.toUpperCase()==a.toUpperCase()){return b.parentNode}b=b.parentNode}}function BindOnClick(){var a=GetGridRow();if(a&&a.length>0){var c=null;for(var d=0;d<a.length;d++){var b;if(a[d].outerHTML.indexOf("<td")>-1||a[d].outerHTML.indexOf("<TD")>-1){b=getElementsByClassName("fz14","a",a[d],true)[0]}else{try{c=getElement(getElementsByClassName("GridTitleDiv","div",a[d],true)[0].childNodes);b=getElement(c?c.childNodes:null);if(!b){if(getElementsByClassName("title_e","h3",a[d],true).length>0&&getElementsByClassName("title_e","h3",a[d],true)[0].childNodes.length>0){b=getElementsByClassName("title_e","h3",a[d],true)[0].childNodes[0]}else{if(getElementsByClassName("title_c","h3",a[d],true).length>0&&getElementsByClassName("title_c","h3",a[d],true)[0].childNodes.length>1){b=getElementsByClassName("title_c","h3",a[d],true)[0].childNodes[1]}}}}catch(f){}}if(b){try{if(window.attachEvent){b.attachEvent("onclick",function(){addTitToCookic(event.srcElement)})}else{b.addEventListener("click",function(){addTitToCookic(this)},false)}}catch(f){}}}}}function getElement(a){if(!a){return null}var b=a.length;var c=0;while(c<b){if(a[c].nodeType==1){return a[c]}c++}return null}function BindOnClick_DownLoad(){var g=GetGridRow();if(g&&g.length>0){var d=g.length;for(var a=0;a<d;a++){if(g[a].outerHTML.indexOf("<td")>0||g[a].outerHTML.indexOf("<TD")>0){for(var b=0;b<g[a].childNodes.length;b++){var c=g[a].childNodes[b];var k=g[a].childNodes[b].innerHTML;if(k&&(k.indexOf("download.aspx")>-1||k.indexOf("summary.aspx")>-1)){var f=c;try{if(window.attachEvent){f.attachEvent("onclick",function(){addTitToCookic_DownLoad(event.srcElement)})}else{f.addEventListener("click",function(){addTitToCookic_DownLoad(this)},false)}}catch(h){}}}}else{$("a[href]",$(g[a])).each(function(){var j=$(this);var l=j.attr("href");if((l.indexOf("download.aspx")>0)||(l.indexOf("summary.aspx")>0)){j.click(function(){addTitToCookic_DownLoaddiv(this)})}})}}}}function CloseBriefTurnPageTip(){var a=parent.ge("result_tit");if(a){a.style.display="none";setCookie("KNS_TurnPageTip","0")}}$(document).ready(function(){if(!$.support.leadingWhitespace){$(".sharebox").hover(function(){$(this).find("p.fxhide").show()},function(){$(this).find("p.fxhide").hide()})}});var MicroBlogType={_Sina:1,_163:2,_QQ:3,_RenRen:4,_KaiXin:5,_DouBan:6,_Email:7};function IShareMicroblog(a,d){var c=new ShareInstance(a,d);var b=new ShareMicroblog(c._Url,c._Target,c._WindowParam);b.Share()}var ShareInstance=function(a,b){this._O=a;this._Type=b;this._Title="";this._Url="";this._Target="_blank";this._WindowParam="width=450,height=400, menubar=no, scrollbars=no,resizable=yes,location=no, status=no";this.InitParam(a,b)};ShareInstance.prototype.InitParam=function(c,g){var d=this.GetWbTitle(c);var a=encodeURIComponent(d[0]);var b="";if(d[1].indexOf("http://")>-1||d[1].indexOf("https://")>-1){b=encodeURIComponent(d[1])}else{b=encodeURIComponent("http://"+window.location.host+d[1])}this._Title=a;var f="";switch(g){case MicroBlogType._Sina:f=this.GetSinaUrl(a,b);break;case MicroBlogType._163:f=this.Get163Url(a,b);this._Target="newwindow";this._WindowParam="height=330,width=550,top="+(screen.height-280)/2+",left="+(screen.width-550)/2+",toolbar=no, menubar=no, scrollbars=no,resizable=yes,location=no, status=no";break;case MicroBlogType._QQ:f=this.GetQQUrl(a,b);this._Target="转播到腾讯微博";this._WindowParam="width=700, height=680, top=0, left=0, toolbar=no, menubar=no, scrollbars=no, location=yes, resizable=no, status=no";break;case MicroBlogType._RenRen:f=this.GetRenRenUrl(a,b);this._WindowParam="scrollbars=no,width=600,height=450,left=75,top=20,status=no,resizable=yes";break;case MicroBlogType._KaiXin:f=this.GetKaiXinUrl(a,b);this._WindowParam="scrollbars=no,width=600,height=450,left=75,top=20,status=no,resizable=yes";break;case MicroBlogType._DouBan:f=this.GetQQUrl(a,b);this._WindowParam="scrollbars=no,width=600,height=450,left=75,top=20,status=no,resizable=yes";break}this._Url=f};ShareInstance.prototype.GetWbTitle=function(c){var h,d;var g=c.parentNode.parentNode.getElementsByTagName("INPUT")[0];if(g){h=g.value}d=h.split("|");var f=/\<(.*?)\>/ig;var a=d[0].replace(f,"");a+="--文献出自中国知网";var b="http://"+window.location.host+d[1]+"&fxtype=1";d[0]=a;d[1]=b;return d};ShareInstance.prototype.GetSinaUrl=function(a,b){return"http://v.t.sina.com.cn/share/share.php?title="+a+"&url="+b+"&source=bookmark"};ShareInstance.prototype.Get163Url=function(a,b){var c="link=http://news.163.com/&source="+encodeURIComponent("网易新闻")+"&info="+a+" "+b;return"http://t.163.com/article/user/checkLogin.do?"+c+"&"+new Date().getTime()};ShareInstance.prototype.GetQQUrl=function(a,b){var g=encodeURIComponent(document.title);var f=encodeURIComponent(document.location);var c=encodeURI("appkey");var h=encodeURI("");var d="";return"http://v.t.qq.com/share/share.php?title="+a+"&url="+b+"&appkey="+c+"&site="+d+"&pic="+h};ShareInstance.prototype.GetRenRenUrl=function(a,b){return"http://share.renren.com/share/buttonshare.do?link="+b+"&title="+a};ShareInstance.prototype.GetKaiXinUrl=function(a,b){return"http://www.kaixin001.com/repaste/share.php?rtitle="+a+"&rurl="+b+"&rcontent="};ShareInstance.prototype.GetDouBanUrl=function(a,b){return"http://www.douban.com/recommend/?url="+b+"&title="+a};var ShareMicroblog=function(b,c,a){this._Url=b;this._Target=c;this._WindowParam=a};ShareMicroblog.prototype.Share=function(){this.Open(this._Url,this._Target,this._WindowParam)};ShareMicroblog.prototype.Open=function(a,c,b){if(!a){return false}if(!b){b="width=450,height=400, menubar=no, scrollbars=no,resizable=yes,location=no, status=no"}if(!c){c="_blank"}window.open(a,c,b)};function ShareWeibo_xl(a){IShareMicroblog(a,MicroBlogType._Sina);CommonDealNoDiv("","../request/UserLogMark.htm","&ua=xl",null,null)}function ShareWeibo_wy(a){IShareMicroblog(a,MicroBlogType._163);CommonDealNoDiv("","../request/UserLogMark.htm","&ua=wy",null,null)}function ShareWeibo_tx(a){IShareMicroblog(a,MicroBlogType._QQ);CommonDealNoDiv("","../request/UserLogMark.htm","&ua=tx",null,null)}function ShareWeibo_rr(a){IShareMicroblog(a,MicroBlogType._RenRen);CommonDealNoDiv("","../request/UserLogMark.htm","&ua=rr",null,null)}function ShareWeibo_kx(a){IShareMicroblog(a,MicroBlogType._KaiXin);CommonDealNoDiv("","../request/UserLogMark.htm","&ua=kx",null,null)}function ShareWeibo_db(a){IShareMicroblog(a,MicroBlogType._DouBan);CommonDealNoDiv("","../request/UserLogMark.htm","&ua=db",null,null)}function ShareWeibo_em(a){var k=parent.$("#singleDB").val();var j=a.parentNode.parentNode.parentNode.parentNode;var b=j.getElementsByTagName("INPUT")[0];if(j.innerHTML.toLowerCase().indexOf("<td")<0){b=j.parentNode.parentNode.getElementsByTagName("INPUT")[0]}var d=b.value.split("!");var h=d[0];var f=d[1];if(typeof k=="undefined"){k=h.substring(0,4)}var c="dbcode="+k+"&dbname="+h+"&filename="+f;var g="../PopUp/ShareEmail.aspx?"+encodeURIComponent(c);window.open(g,"_blank","'width=580,height=430, menubar=no, scrollbars=no,resizable=yes,location=no, status=no';")}function GetShareWeibos(){var a='<p class=\'fxhide\'><span>分享到</span><a href="javascript:void(0);" onclick="ShareWeibo_xl(this);" class="logo-xl" title="新浪微博">新浪微博</a><a href="javascript:void(0);" onclick="ShareWeibo_tx(this);" class="logo-tx" title="腾讯微博">腾讯微博</a><a href="javascript:void(0);" onclick="ShareWeibo_rr(this);" class="logo-rr" title="人人网">人人网</a><a href="javascript:void(0);" onclick="ShareWeibo_kx(this);" class="logo-kx" title="开心网">开心网</a><a href="javascript:void(0);" onclick="ShareWeibo_wy(this);" class="logo-wy" title="网易微博">网易微博</a><a href="javascript:void(0);" onclick="ShareWeibo_em(this);" class="logo-yx" title="EMIAL">EMIAL</a></p>';document.write(a)}function ShareAction(a,m){var q=parent.$("#singleDB").val();var l=parent.$("#txt_1_value1").val();var n=getValueFromCookie("cnkiUserKey");var b=$("#crrsUrl").val();var p=a.parentNode.parentNode.parentNode.parentNode;var c=p.getElementsByTagName("INPUT")[0];if(p.innerHTML.toLowerCase().indexOf("<td")<0){c=p.parentNode.parentNode.getElementsByTagName("INPUT")[0]}var f=c.value.split("!");var k=f[0];var g=f[1];if(typeof q=="undefined"){q=k.substring(0,4)}else{if("SCDB|SCPD|CDMD|CIPD|SCOD|CISD|CRFD|CFED".indexOf(q.toUpperCase())>-1){q=k.substring(0,4)}}var h="share.ashx?dbCode="+q+"&filename="+g+"&keyvalue="+encodeURIComponent(l);var j=document.URL;if(typeof WriteActionLog!="undefined"&&Object.prototype.toString.call(WriteActionLog)=="[object Function]"){WriteActionLog(h,j)}if(b==""||typeof b==undefined){b="http://acad3.cnki.net/CRRS"}var d=b+"/Services/Share.ashx?dbcode="+q+"&dbname="+k+"&filename="+g+"&target=kns&type="+m+"&keyvalue="+encodeURIComponent(l)+"&cnkiUserKey="+n;window.open(d,"_blank","width=480,height=430, menubar=no, scrollbars=no,resizable=yes,location=no, status=no")}function GetShareServer(){var a='<p class=\'fxhide\'><span>分享到</span><a href="javascript:void(0);" onclick="ShareAction(this,\'xl\')" class="logo-xl" title="新浪微博"></a><a href="javascript:void(0);" onclick="ShareAction(this,\'tx\')" class="logo-tx" title="腾讯微博"></a><a href="javascript:void(0);" onclick="ShareAction(this,\'rr\')" class="logo-rr" title="人人网"></a><a href="javascript:void(0);" onclick="ShareAction(this,\'kx\')" class="logo-kx" title="开心网"></a><a href="javascript:void(0);" onclick="ShareAction(this,\'wy\')" class="logo-wy" title="网易微博"></a><a href="javascript:void(0);" onclick="ShareWeibo_em(this);" class="logo-yx" title="邮箱">邮箱</a></p>';document.write(a)}var FileNameInfo=function(c,b,d,a){this.T=c;this.F=b;this.I=d;this.Q=a};var StorageType={Local:1,Session:2,Cookie:3};var FileNameS=function(a){this._Count=-1;this._StorageType=a;this._FileNameS=this.getFileNamesStr();this._FileNameArray=this.getFileNameArray();this.Count();this._FileNameObjectS=null;this._IsExist=function(){};this._QueryIDArray=this.getQueryIDArray()};FileNameS.prototype._StorageType=StorageType.Cookie;FileNameS.prototype.Count=function(){if(this._Count<0){this._Count=this._FileNameArray.length}return this._Count};FileNameS.prototype.FileNameObjectS=function(){if(!this._FileNameObjectS){this._FileNameObjectS=this.getFileNameOArray()}return this._FileNameObjectS};FileNameS.prototype.getFileNamesStr=function(){var a=this.getFileNameS("FileNameS",this._StorageType);if(a&&a.indexOf("cnki:")==0){a=a.replace(/^cnki:/gi,"")}else{a=""}return a};FileNameS.prototype.getFileNameArray=function(){var a=new Array();if(this._FileNameS.length>0){a=this._FileNameS.split(",")}return a};FileNameS.prototype.getQueryIDArray=function(){var b=new Array();var d=this._FileNameArray.length;if(d>0){while(d--){var c=this._FileNameArray[d].split("!");if(c.length==4){if(!this.IsExist(b,c[3])){b.push(c[3])}}}}return b};FileNameS.prototype.IsExist=function(a,b){if(Object.prototype.toString.call(a)=="[object Array]"&&b&&typeof b=="string"){var c=a.length;while(c--){if(a[c]==b){return true}}return false}};FileNameS.prototype.getFileNameOArray=function(){var c=new Array();var a=this._FileNameArray.length;for(var d=0;d<a;d++){var f=this._FileNameArray[0];var b=f.split("!");if(b.length==4){c.pop(new FileNameInfo(b[0],b[1],b[2],b[3]))}}return c};FileNameS.prototype.getTableNameFileNames=function(a){if(!a||a.length<=0){return""}var b=a.split("!");if(b.length==4){return b[0]+"!"+b[1]}return""};FileNameS.prototype.handlerRegexSpcileChar=function(a){if(a){return a.replace(/[\(|\)|\+|\.|\*]/g,function(b){return"\\"+b})}return a};FileNameS.prototype.removeFileName=function(b,c){var a=this.getTrueSaveFileNames(b,c);this.setFileNameS("FileNameS",a,this._StorageType);$("#formfilenames").val(a)};FileNameS.prototype.getTrueSaveFileNames=function(l,g){var b="cnki";var k=this._FileNameS;if(!k||k.length<=0){return}var j="";if(g){j=l}else{j=this.getTableNameFileNames(l)}if(j.length<=0){return}var f=this.handlerRegexSpcileChar;var d=function(n,m){var p=new RegExp("^"+f(m)+"$");n=n.replace(p,"");p=new RegExp("^"+f(m)+",");n=n.replace(p,"");p=new RegExp(","+f(m)+"$");n=n.replace(p,"");p=new RegExp(","+f(m)+",");n=n.replace(p,",");return n};j=f(j);var h=new RegExp(j+"[^,]*","ig");var c=k.match(h);if(c&&c.length>0){for(var a=0;a<c.length;a++){k=d(k,c[a])}}if(k!=""){k=b+":"+k}else{k=b+":"}return k};FileNameS.prototype.isExistFileName=function(a){if(this._FileNameS&&a&&a.length>0){if(this._FileNameS.indexOf(a)>=0){return true}}return false};FileNameS.prototype.addFileName=function(a){var b=this.getTableNameFileNames(a);if(this.isExistFileName(b)){return}addToCookie(a)};FileNameS.prototype.addToCookie=function(a){company="cnki";cookie=new String(this.getFileNameS("FileNameS"),this._StorageType);if((cookie.length>0)&&((cookie.substring(0,cookie.indexOf(":"))==company))){if(cookie.length-1==cookie.indexOf(":")){this.setFileNameS("FileNameS",cookie+a,this._StorageType)}else{this.setFileNameS("FileNameS",cookie+","+a,this._StorageType)}}else{this.setFileNameS("FileNameS",company+":"+a,this._StorageType)}};FileNameS.prototype.getFileNameS=function(a){if(window.localStorage){this.getFileNameS=function(b,c){var d="";if(c==StorageType.Session){d=window.sessionStorage.getItem(b)}else{d=window.localStorage.getItem(b)}return d}}else{this.getFileNameS=function(b,c){return getCookie(b)}}return this.getFileNameS(a,this._StorageType)};FileNameS.prototype.setFileNameS=function(a,c,b){if(window.localStorage){this.setFileNameS=function(d,g,f){if(f==StorageType.Session){window.sessionStorage.setItem(d,g)}else{window.localStorage.setItem(d,g)}}}else{this.setFileNameS=function(d,g,f){setCookie(d,g,f)}}this.setFileNameS(a,c,this._StorageType)};var searchInfo={saveKey:"SEARCHINFO",keyCollection:new Array(),valueCollection:new Array(),count:0,set:function(b,a){},get:function(a){},init:function(){if(!this.isExistFileNames()){this.clear();return}var a=this.get(this.saveKey);if(Object.prototype.toString.call(a)=="[object String]"&&a!=""){this.splitInfoStr(a);this.updataCount()}else{if(Object.prototype.toString.call(this.emptyCallBackFun)=="[object Function]"){this.emptyCallBackFun()}}},updataCount:function(){this.count=this.keyCollection.length},splitInfoStr:function(b){if(typeof b=="string"){var a=b.split(",");var c=a.length;if(c>0){while(c--){this.fillKV(a[c])}}}},fillKV:function(a){if(typeof a=="string"){var b=a.split("!");if(b.length==3){b[0]=b[0]||"";if(b[0]!=""&&b[1]&&b[2]){this.keyCollection.push(b[0]);this.valueCollection.push(b[1]+"!"+b[2])}}}},indexOf:function(b){if(this.count>0){var a=this.count;while(a--){if(this.keyCollection[a]==b){return a}}}return -1},isExist:function(a){if(this.indexOf(a)>=0){return true}return false},getV:function(b){var a=this.indexOf(b);if(a>=0){return this.valueCollection[a]}return""},addKV:function(c,b){var a=this.indexOf(c);if(a>=0&&b){this.keyCollection[a]=c;this.valueCollection[a]=b}else{this.keyCollection.push(c);this.valueCollection.push(b)}this.updataCount();this.save()},addKVCahce:function(c,b,a){if(window.localStorage){if(a==StorageType.Session){window.sessionStorage.setItem(c,b)}else{window.localStorage.setItem(c,b)}}else{setCookie(c,b,a)}},remove:function(b){var a=this.indexOf(b);if(a>=0){this.keyCollection=this.deletArray(this.keyCollection,a);this.valueCollection=this.deletArray(this.valueCollection,a);this.updataCount();this.save()}},deletArray:function(a,b){return a.slice(0,b).concat(a.slice(++b))},save:function(a){var b=this.getStr();var c=this.saveKey;this.set(c,b);if(window.localStorage){if(a==StorageType.Session){window.sessionStorage.setItem(c,b)}else{window.localStorage.setItem(c,b)}}else{setCookie(c,b,a)}},clear:function(){this.count=0;this.keyCollection=new Array();this.valueCollection=new Array();this.set(this.saveKey,"")},isExistFileNames:function(){var a=new FileNameS();if(a._Count<=0){return false}return true},getStr:function(){var b=this.count;var a="";while(b--){if(this.keyCollection[b]&&this.valueCollection[b]){a+="{0}!{1},".format(this.keyCollection[b],this.valueCollection[b])}}if(a.length>0){a=a.substring(0,a.length-1)}return a},emptyCallBackFun:function(){}};$(document).ready(function(){if(window.top&&window.top.PageStates&&window.top.PageStates.searchInfo){searchInfo.set=function(b,a){window.top.PageStates.searchInfo.add(b,a)};searchInfo.get=function(b){var a=window.top.PageStates.searchInfo.get(b);if(!a){a=$("#searchinfo").val()}return a}}searchInfo.init()});var CheckBoxFileNamesTempCache=null;function cacheCurSearchOP(a,b){var g="";if(a){if(a=="clear"){CheckBoxFileNamesTempCache=null}else{if(a=="or"){var d=new FileNameS();var m=d._QueryIDArray;var c=m.length;while(c--){if(m[c]==b){return}}CheckBoxFileNamesTempCache=null}else{if(CheckBoxFileNamesTempCache==b){return}CheckBoxFileNamesTempCache=b}}g+="&ot="+a;var j=$("#singledb").val();var f=window.location.href;j=j||GetQueryStringByName(f,"dbprefix");var h=GetQueryStringByName(f,"pagename");if(b){g+="&skey="+b}if(j){g+="&dbc="+j}if(h){g+="&pagename="+h}CommonDealNoDiv("oscache&","../request/cacheHandler.ashx",g,function(k){},"","GET")}}function briefTableListJSEvent(){handlerAllSelectState();$("input[type='checkbox'][name='FileNameS']").bind("click",FillSelectCount);$("#selectCheckbox").bind("click",FillSelectCount);fillCount2Content()}function handlerAllSelectState(b){b=b||"selectCheckbox";var a=$("input[type='checkbox'][name='FileNameS']").length;if(a!=0&&a==$("input[type='checkbox'][name='FileNameS']:checked").length){$("#"+b).attr("checked",true)}else{$("#"+b).attr("checked",false)}}function fillCount2Content(b,f){b=Object.prototype.toString.call(b)=="[object Document]"?b:document;f=f||"selectCount";var a=0;var d=function(){var g=new FileNameS();return g.Count()};a=d();var c=function(g,l,h){try{var j=g.getElementById(l);if(j){j.innerHTML=h}}catch(k){}};c(b,f,a);c(window.top.document,"selectCountNew",a);return a}function FillSelectCount(b,f){b=Object.prototype.toString.call(b)=="[object Document]"?b:document;f=f||"selectCount";var a=0;a=fillCount2Content(b,f);if(a>0){var c=function(g){return parent.document.getElementById(g)};var d=function(j,h){if(parent){var g=c(j);if(g){g.style.display=h}}};if(window.screen.width>=1376){d("literSelectFolder","block");d("literSelectBtn","none")}}return a}function hiddenTR(d,a,b){if(!confirm("确定删除吗?")){return}var f="";if(d){if(d.length>=d.indexOf("!")+1){f=d.substring(d.indexOf("!")+1)}var c=new FileNameS();c.removeFileName(d,true)}modifyCheckBoxState(f);modifyTrNumber(a,b);handlerAllSelectState("allSelectBox")}function modifyCheckBoxState(a){if(a.indexOf("(")>-1){$("#"+a.replace(".","\\.").replace("(","\\(").replace(")","\\)")+" input[type='checkbox']").each(function(){$(this).attr("checked",false)});$("#"+a.replace(".","\\.").replace("(","\\(").replace(")","\\)")).remove()}else{$("#"+a.replace(".","\\.")+" input[type='checkbox']").each(function(){$(this).attr("checked",false)});$("#"+a.replace(".","\\.")).remove()}}function setCheck(b,c,a){e=b.forms[0].elements;for(i=0;i<e.length;i++){if(e[i].type=="checkbox"&&e[i].name=="FileNameS"){if(e[i].value.indexOf(c)>=0){e[i].checked=a;break}}}}function modifyTrNumber(b,c){if(b){if(typeof c=="undefined"){return}if(typeof c!="Number"){c=parseInt(c)}if(typeof c=="NaN"){return}SetDisplayValue(b+c.toString(),"none");var a=function(l){var h=0;var j=function(m){if(h>=5){return null}h++;if(m&&m.parentNode){if(m.parentNode.tagName=="TR"){return m.parentNode}return j(m.parentNode)}};var k=j(l);if(k){curColor=k.bgColor;if(curColor){curColor=curColor.toLowerCase();if(curColor=="#ffffff"){curColor="#f6f7fb"}else{curColor="#ffffff"}k.bgColor=curColor}}};var g=1;var f=1;var d=ge(b+(++c).toString());while(d){if(d.style.display!="none"){f=parseInt(d.innerHTML);if(typeof f!="NaN"){d.innerHTML=(--f).toString();a(d,f);modifyclick(b+c,f);$("#"+b+c).attr("id",b+f.toString()).attr("name",b+f.toString())}}d=ge(b+(++c).toString())}}}function modifyclick(id,num){var obj=$("#"+id).parent().parent().find(".deleteicon");if(ISIE){$(obj).unbind("click");$(obj).click(function(){eval($(obj).attr("onclick").toString().replace("'"+(num+1)+"')","'"+num+"')"))})}else{$(obj).attr("onclick",$(obj).attr("onclick").toString().replace("'"+(num+1)+"')","'"+num+"')"))}}function SubmitSelect(b,h,g,f){var d=document.getElementById("valueForm");if(d){if(!f){FillFileNamesParam()}var c=true;var a=50;a=parseInt(g);if(isNaN(a)){c=false}var k=getEmValue("formfilenames");if(!k||k.length<0){alert("请先选取文献");return}if(c){var j=k.split(",");if(j.length>a){alert("最多选择"+a+"篇文献,请重新选择！");return}}if(h){d.target=h}d.action=b;d.submit()}}function FillFileNamesParam(){FillValue("formfilenames","");var a="";var b=document.forms[0].elements;for(i=0;i<b.length;i++){if(b[i].type=="checkbox"&&b[i].name=="FileNameS"){if(b[i].checked==true){if(!isHidden(b[i].value)){continue}if(a&&a.length>0){a+=","+b[i].value}else{a=b[i].value}}}}FillValue("formfilenames",a)}function isHidden(d){if(d){var a=d.split("!");if(a.length>1){var c=a[1];var b=ge(c);if(b){if(b.style&&b.style.display=="none"){return false}}}}return true}function AllSelect(a){if(!a){return}if(a.checked){setAllCheck(true)}else{setAllCheck(false)}}function setAllCheck(a){if(typeof a!="boolean"){a=false}e=document.forms[0].elements;for(i=0;i<e.length;i++){if(e[i].type=="checkbox"&&e[i].name=="FileNameS"){e[i].checked=a}}}function ClearAndRefresh(){if(ClearAll(false,"您确定全部清除吗?",true)){$("#allSelectBox").attr("checked",false);$("table.GridTableContent tr").each(function(){if($(this).attr("class")!="GTContentTitle"){$(this).remove()}});var a=new FileNameS();a.setFileNameS("FileNameS","")}}function ClearAll(b,c,a){if(b==false&&!c){c=""}if(c!=""&&!c){c="请您重新检索、选择！";b=true}if(c&&c!=""){if(!confirm(c)){return false}}if(!a){HandlerParent(b);cacheCurSearchOP("clear")}return true}function HandlerParent(b){var a=null;if(!window.opener||typeof window.opener=="undefined"){a=document;setCookie("FileNameS","cnki:",StorageType.Local);searchInfo.clear()}else{a=window.opener.document;if(a){clearAllMarks(a.forms[0])}}if(a){clearAllMarks(this.form);if(b){a.location.reload();window.close()}else{SetSelectCount(a)}}}function SetSelectCount(a,b){if(a){FillSelectCount(a,b);var c=a.getElementById("selectCheckbox");if(c){c.checked=false}}}function zeroSelectTip(){if(numMarked()==0){clearAllMarks();FillSelectCount();alert("请先选取文献");return false}return true}function checkAll(a){e=document.forms[0].elements;for(i=0;i<e.length;i++){if(e[i].type=="checkbox"&&e[i].name=="FileNameS"){if(numMarked()>=100){alert("不能超过100个,若要重新选择,请按清除按钮,再进行选取操作");return false}else{if(e[i].checked==false){if(document.cookie.length+e[i].value.length>4096){alert("如要选择更多，请您升级浏览器到最新版本。");return false}addToCookie(e[i].value);e[i].checked=true}}}}return true}function BindOnlick_ShowWait(){$("#J_ORDER,.pageBar_bottom").find("a").click(function(){var a=this.href;if(a.indexOf("brief.aspx?")>0){DoParentFunc("ShowWaitDiv")}})}function BindTurnPage_TitleTip(){$(".pageBar_bottom").find("a").each(function(){$(this).attr("title",message.PageTurnTip)});$("#Page_next,#Page_prev").attr("title",message.PageTurnTip)}function DoParentFunc(a){if(parent==null){return}if(parent[a]==undefined){return}parent[a]()}function setAuShow(){var a=$("table.GridTableContent > tbody > tr:not(.GTContentTitle) > td.author_flag");a.each(function(){var f=$(this).html();var d;f=removeScriptChar(f);var c=/<a[^>]*>[^<>]*(((<(font|span)[^>]*>)[^<>]*)+((<\/(font|span)>)[^<>]*)+)*<\/a>/ig;if(c.test(f)){d=f.match(c)}else{d=f.split(";")}var b=d.length;if(b>5){f=d.slice(0,5).join(";")+"<a onclick='javascript:showMoreAU(this)' title='显示全部作者' class='showAll'></a><span style='display:none'>;"+d.slice(5).join(";")+"</span>"}$(this).html(f)})}function showMoreAU(a){$(a).hide();$(a).next("span").show();SetFrameHeight()}function removeScriptChar(b){b=b.replace(/[\r|\n]/ig,"");var a=/<script[^>]*?>[|\w|\W]*?<\/.*?script.*?>/ig;b=b.replace(a,"");b=$.trim(b);return b}function setScdbAuAndJn(){SetSCDBAuLink()}function setWwjdAuAndJn(){SetWwjdAuLink()}function SetAuLink(b,d){var a=$(b);a.each(function(){var g=$(this).html();var f;g=getWWJDaulist(g,d);f=g.split(";");var c=f.length;if(c>5){g=f.slice(0,5).join(";")+"<a onclick='javascript:showMoreAU(this)' title='显示全部作者' class='showAll'></a><span style='display:none'>;"+f.slice(5).join(";")+"</span>"}$(this).html(g)})}function SetWwjdAuLink(){SetAuLink("table.infoboxHor > tbody > tr > td.rewwjd_au","WWJD")}function SetSCDBAuLink(){SetAuLink("table.infoboxHor > tbody > tr > td.rescdb_au","CJFQ")}function getWWJDaulist(c,d){var b="";var f="<a class='KnowledgeNetLink' target='knet' href='/kns/popup/knetsearchNew.aspx?sdb="+d+"&sfield="+encodeURI("作者")+"&skey={0}'>{0}</a>";if(c==""||c=="null"||c==null){return""}else{c=c.replace(/\;;/g,"; ");var a=c.split(";");for(i=0;i<a.length;i++){if(a[i]!=""&&i<5){b+=f.replace(/\{0}/g,a[i])+"; "}}return b}}function qkInfoCall(){var a=$("table.GridTableContent > tbody > tr:not(.GTContentTitle) > td.cjfdyxyz");a.each(function(){$(this).hoverDelay({hoverDuring:500,outDuring:0,hoverEvent:function(g,c){var f=$(this).find("input:hidden").val();if(f==""){return}var d=$(this).find(">div");if(d.length==0){GetPeriodicalInfo(f,"cjfdbaseinfo",this)}else{d.show();QYOp(f,true)}if($(this).find("a").length==0){return}var p=$(this).find("a").position().left;var h=$(this).position().top+$(this).outerHeight(true);var l=$("#resultFilter",window.parent.document).position().top;var m=$("#resultFilter",window.parent.document).outerHeight(true);var k=($(window.parent.document.body).width()-$("#reselectboxNavi",window.parent.document).outerWidth(true))/2;var n=$(window.parent.document.body).width()-$("#searchdiv",window.parent.document).outerWidth(true)-($(window.parent.document.body).width()-1200)/2;var j=$(this).outerHeight(true);var b=$(this).outerWidth(true);$("#QkYxyz",window.parent.document).css("top",h+l+m+"px").css("left",p+k+b+"px").css("position","absolute");$("#RQkYxyz",window.parent.document).css("top",h+l+m+"px").css("left",p+n+b+"px").css("position","absolute")},outEvent:function(){$("#QkYxyz",window.parent.document).hide();$("#RQkYxyz",window.parent.document).hide()}})})}function GetPeriodicalInfo(f,d,b){var g=parent.yxyzValue;var c=getYxyz(f,g);if(c==""){var a="&pxkm="+f+"&dbname="+d;if(f!=""&&d!=""){CommonDealNoDiv("yxyz&","../request/GetJournalInfoHandler.ashx",a,function(h){if(h.readyState!=ReadyState.Complete){return}if(h.status==HttpStatus.OK&&h.responseText!=""){c=h.responseText;parent.yxyzValue+="|"+f+c;creatInfoHTML(f)}},"","GET")}}else{}QYOp(f,true)}function getYxyz(d,c){var b="";var f=c.split("|");for(i=0;i<f.length;i++){if(f[i].indexOf(d)>-1){b=f[i].replace(d,"");continue}}return b}function QYOp(c,d){var b=parent.document.getElementById("QkYxyz");var a=parent.document.getElementById("RQkYxyz");if(b){if(d){b.style.display="";creatInfoHTML(c)}else{b.style.display="none"}}if(a){if(d){a.style.display="";creatInfoHTML(c)}else{a.style.display="none"}}}function creatInfoHTML(d){var f=parent.document.getElementById("QkYxyz");var a=parent.document.getElementById("RQkYxyz");var b=parent.yxyzValue;var c=getYxyz(d,b);if(f){f.innerHTML=RederYxyzDiv(d,c)}if(a){a.innerHTML=RederYxyzDiv(d,c)}}function RederYxyzDiv(d,a){var f="/fengmian";if(document.getElementById("fengmianPath")){f=document.getElementById("fengmianPath").value}var c="";if(a!=""){if(typeof a.split("：")[0]!="undefined"&&a.split("：")[0]!=""){c="<p>复合影响因子："+a.split("：")[0]+"</p>"}if(typeof a.split("：")[1]!="undefined"&&a.split("：")[1]!=""){c+="<p>综合影响因子："+a.split("：")[1]+"</p>"}}var b='<img style="width:120px;" src="'+f+"/CJFD/big/"+d+'.jpg" />'+c;return b}function RevertUserSelect(){var c=new FileNameS();var a=c._FileNameS;if(!a||a.length<=0){return}var b=function(k,g){if(k&&g&&k!=""&&g!=""){var h=k.indexOf("!")+1;var j=k.substring(0,k.indexOf("!",h));return g.indexOf(j)>=0?true:false}return false};if(document.forms[0]){var d=document.forms[0].elements;for(i=0;i<d.length;i++){if(d[i].type=="checkbox"&&d[i].name=="FileNameS"){if(b(d[i].value,a)){d[i].checked=true}}}}}function saveAs(b){var a="../request/CustomizeOperate.aspx"+getPParam(b);window.open(a)}function exportBatch(){submitToUrl("../ViewPage/batch.aspx","batch")}function exportArtical(b){var a="../ViewPage/viewsave.aspx"+getPParam(b);submitToUrl(a,"exportArtical")}function anisysartical(a){if(numMarked()==0){$("#selectCheckbox").attr("checked","true");checkAll("this.form");FillSelectCount()}submitToUrl(analysisURL,"analysisArtical")}function anisysresult(){try{if("undefined"!=typeof(window.parent.Visualization)){window.parent.Visualization.pop.submitAll()}else{alert("Waiting for load visual scripts")}}catch(a){}}function getPParam(a){if(typeof a=="string"&&a!=""){return"?p="+a}return""}function submitToUrl(c,g,a){var d=new FileNameS();params=d._FileNameS;if(!params){params=GetInputValue("formfilenames")}var b=new Array();b.push(createElement("input","hidden","formfilenames",params||""));b.push(createElement("input","hidden","uid",parent.$("#userid").val()||""));var f=searchInfo.getStr();if(f&&f.indexOf("undefined")<0){b.push(createElement("input","hidden","searchinfo",f||""))}postSubmit(c,params,b,g)}function postSubmit(g,f,b,c){var a="postSubmitForm";removeObj(a);temp=document.createElement("form");g=addRandomNumger(g);temp.action=g;temp.method="post";temp.target=c||"complexPage";temp.style.display="none";temp.id=a;if(b){for(var d=0;d<b.length;d++){temp.appendChild(b[d])}}document.body.appendChild(temp);temp.submit();return temp}function removeObj(b){var a=document.getElementById(b);if(a){document.body.removeChild(a)}}function addRandomNumger(a){if(a){var b=new Date;if(a.indexOf("?")<0){a+="?"}else{a+="&"}a+="t="+b.getTime()}return a}function createElement(f,d,c,b){var a=document.createElement(f);a.type=d;a.name=c;a.value=b;return a}function submitReport(c,d){var b=document.getElementById("valueForm");if(b){var a=new FileNameS();FillValue("formfilenames",a._FileNameS);if(d){b.target=d}b.action=c;b.submit()}}function clearAllMarks(a){if(!a){a=document.forms[0]}if(a){var b=a.elements;for(i=0;i<b.length;i++){if(b[i].type=="checkbox"&&b[i].name=="FileNameS"){b[i].checked=false}}}setCookie("FileNameS","cnki:",StorageType.Local)}function isSenMode(){var a=GetQueryStringByName(window.location.href,"issen");if(!a){a=$("#issen").val()}return a=="1"}$("input[name='FileNameS']").live("click",function(){var a=$(this).val();var d=a.substring(a.lastIndexOf("!")+1);if($(this).attr("checked")){var b=GetQueryStringByName(window.location.href,"dbprefix")||"SCDB";if($("#SqlValue").val()){searchInfo.addKV(d,b+"!"+$("#SqlValue").val())}$file=$(this).attr("href");$title=$(this).attr("id");if($("#selectCount").length>0){$("#selectCount").fadeIn("medium");$offset=$(this).offset();$offsetfavbar=$("#selectCount").offset();$(".flyingAdd").css("left",$offset.left+"px");$(".flyingAdd").css("top",$offset.top+"px");$(".flyingAdd").animate({left:($offsetfavbar.left)+"px",top:($offsetfavbar.top)+"px",opacity:"0.1",fontSize:"0px"},800,function(){$(".flyingAdd").css({left:"-1000px",top:"-100px",opacity:"1",fontSize:"50px"})})}cacheCurSearchOP("os",d)}else{removeSearchInfo(d);cacheCurSearchOP("or",d)}handlerAllSelectState()});function removeSearchInfo(b){var a=new FileNameS();if(a._QueryIDArray.length<=0){searchInfo.clear();return}if(!a.IsExist(a._QueryIDArray,b)){searchInfo.remove(b)}}$("#selectCheckbox").live("click",function(){var b=$("input[name='FileNameS']");if(b.length>0){var a=$(b[0]).val();var f=a.substring(a.lastIndexOf("!")+1);if($(this).attr("checked")){var d=GetQueryStringByName(window.location.href,"dbprefix")||"SCDB";searchInfo.addKV(f,d+"!"+$("#SqlValue").val());cacheCurSearchOP("os",f)}else{removeSearchInfo(f);cacheCurSearchOP("or",f)}}});function searchJournal(d){if(d){var c=parent.$("#txt_1_sel");c.children()[9].selected=true;var a=$(d).text();var b=/[<>\?:"\\;'\[\]\/]/im;if(a&&b.test(a)){alert("该文本中含有特殊字符，请手工输入来源的值！");return false}parent.$("#txt_1_value1").val(a);parent.$("#btnSearch").click()}}function recWWJDAddToTable(){if(parent.$("#txt_1_value1").val()!=""&&document.URL.toLocaleLowerCase().indexOf("turnpage")<0){if(window.parent.location.href.toLowerCase().indexOf("default_result.aspx")>0){var a=typeof RecResource=="function"?new RecResource():{};a.GetRecWWJD2ID(parent.$("#txt_1_value1").val(),1,true,"relevantExpertDiv")}}}function SubCountDownLoad(b,g){var d="";var a="";if(b==0){if(g){var c=$(g).closest("td").find("a[class ^= 'briefDl']");c=!(c.length>0)?$(g).closest("td").find("a[class ^= 'brief_downloadIcon']"):c;if(c&&c.length>0){d=$(c).attr("href");addTitToCookic_DownLoad(c[0])}}}if(b==1){if(g){var c=$(g).closest(".GridContentDiv").find("a[class ^= 'briefDl']");c=!(c.length>0)?$(g).closest(".GridContentDiv").find("a[class ^= 'brief_downloadIcon']"):c;if(c&&c.length>0){d=$(c).attr("href");addTitToCookic_DownLoaddiv(c[0])}}}if(window.VBArray){var f=document.createElement("a");f.target="_blank";f.href=d;document.body.appendChild(f);f.click();document.body.removeChild(f)}else{window.open(d)}}function WriteLog(c,h,b){try{if(c=="undefined"||c==""||h=="undefined"||h==""){return}var k=getValueFromCookie("cnkiUserKey");var j="";if(window.parent.$("#klogin_isPersonal").val()=="1"){j=window.parent.$("#klogin_userName").val()}else{if($("#klogin_isPersonal").val()=="1"){j=$("#klogin_userName").val()}}var a=$("#krsUrl").val();var d="";if(b=="download"){d="download.aspx?dbCode="+c+"&fileName="+h}else{if(b=="detail"){d="detail.aspx?dbCode="+c+"&fileName="+h}}var f=window.location;if(typeof WriteActionLog!="undefined"&&Object.prototype.toString.call(WriteActionLog)=="[object Function]"){WriteActionLog(j,k,d,f)}}catch(g){}}function GetRecommend(){var a=window.location;var l=GetQueryStringByName(a,"turnpage");var k=GetQueryStringByName(a,"Param");var d=GetQueryStringByName(a,"sorttype");if(l||k||d){return}var c=$("#krsUrl").val();if(!c||c=="undefined"){c="//kns.cnki.net/KRS"}var h=getUInfoFromECP("uname");var j=getValueFromCookie("cnkiUserKey");var f=escape(parent.$("#txt_1_value1").val());if(f==""){parent.$("#recommendTitle").hide();parent.$("#recommendContent").hide();parent.$("#recommendContent").html();return}var g=new CoreDomainLoadJson();var b=c+"/KRSHandler.ashx?userName="+h+"&cnkiUserKey="+j+"&keyWord="+f;g.Load(b,function(){if(typeof recommendCall!="undefined"){var t=recommendCall.recommendInfo;var q='<ul class="listSpan">';if(t.length!=0){for(var m=0;m<t.length;m++){var u=t[m].DBCode;var r=t[m].FileName;var n=t[m].TitleName;var p=t[m].TableName;if(n==""||n==null){continue}var s=$("#bathPath").val()+"/detail/detail.aspx?DbCode="+u+"&dbname="+p+"&filename="+r;q+="<li><a target='_blank' href='"+s+"' title='"+n+"'>"+n+"</a></li>"}q+="</ul>";parent.$("#recommendContent").html(q);parent.$("#recommendTitle").show();parent.$("#recommendContent").show()}}else{parent.$("#recommendTitle").hide();parent.$("#recommendContent").hide()}},"krsRecommend")}$(document).ready(function(){var a=$(".attention");a.bind("click",function(){var b=$(this);var f=b.parent().parent().parent().siblings(".GridTitleDiv");var c=f.find("a.fz14").attr("href");var d=unescape(GetQueryStringByName(c,"type"));var g=GetQueryStringByName(c,"skey");var k=GetQueryStringByName(c,"scode");var l=$("#deliveryPath").val();var h=$("#userid").val();var n=getValueFromCookie("cnkiUserKey");var m=l+"ExtendDB/AddAttention.ashx?un="+h+"&skey="+n+"&type="+d+"&content="+escape(k+"#"+g)+"&dbName=";var j=new CoreDomainLoadJson();j.Load(m,function(){if(typeof result!="undefined"){var r=result.data;if(r==null){return}for(var u=0;u<r.length;u++){var s=r[u].code;var t=r[u].msg;if(s=="1"){var q=b.next(".popflow");q.show();q.delay(8000).hide(0);var v=$("#mycnkiUrl").val();var p=$("#userid").val();v=v+"?uid="+p;q.find(".des").children().attr("href",v);q.find(".close").bind("click",function(){q.hide()})}}}})})});function RenderMoreInfo(g){var a=document.getElementById(g).value;if(a==null||a==""){return}var d=a;var f="<p><b>【摘&nbsp &nbsp要】</b>"+d+"</p>";var c="<>";var b="";if(d!=""&&d!=null){b+=f}if(b!=""){document.write("<div id="+g+"_1 class='ChkdMoreInfoDiv'><div class='ChkdMoreInfoHd'><a class='ChkdMoreInfoHide' href='javascript:void(0);' onclick=\"HideDetail('"+g+"_1')\">X</a></div><div class='ChkdMoreInfoBd'>"+b+"</div></div>")}}function setDisplay(b,a){var c=document.getElementById(b);if(c&&c.style){c.style.display=a}}function HideDetail(a){setDisplay(a,"none")}function ShowDetail(a){setDisplay(a,"block")}function AddFavToKpc(c){if(!c){return false}var g=getUInfoFromECP("uname");var b=getUInfoFromECP("utype");var j=GetCookie("LID");if(!g||!b||b!="jf"){OpenLoginPage();parent.scroll(0,0);return false}if($(c).text().indexOf("已收藏")>-1){var d="//ishufang.cnki.net/KPC?t="+Math.random()+"#fav_paper";window.open(d,"kns_gerenshufang");return false}var h=getSCTypeFilenames(c);if(c){var k=h.split("|")[0].substring(0,4);var f=h.split("|")[1];var a=h.split("|")[0];$.ajax({url:"//ishufang.cnki.net/kpcapi/api/Favorite/AddFav",data:{type:"1",dbCode:k,userId:encodeURIComponent(g),filenameOrBaseid:f,tableName:a,token:j},type:"POST",success:function(l){if(l.IsOk){setColor(c)}else{alert(l.Message)}}})}else{}AddFavToYxpt()}function AddFavToYxpt(){var f=getSCTypeFilenames(o);var j=f.split("|")[0].substring(0,4);var b=f.split("|")[1];var a=f.split("|")[0];var c=j+"|"+a+"|"+b;var g=new Array;g.push(c);var h=GetCookie("LID");try{$.ajax({url:"http://mobile.x.cnki.net/forkns/api/PSMC/AddFiles",beforeSend:function(k){k.setRequestHeader("Content-Type","application/json");k.setRequestHeader("cache-control","no-cache");k.setRequestHeader("token",h)},data:JSON.stringify(g),dataType:"json",type:"POST",success:function(k){}})}catch(d){}}function setColor(a){if(a){$(a).html("已收藏");$(a).css("background-position-x","-20px")}}function getSCTypeFilenames(g){var a="";if(g){var f=d($(g));if(f.length>0){var c=f.val();a=c}else{alert("参数异常！")}}var b=5;function d(h){var j=h.parent().find("input[type='checkbox']");if(b>5){b=0;return null}if(j.length>0){b=0;return j}b++;return d(h.parent())}a=exeStr(a);return a}function getBriefFilenames(){var a="";$("input[name='FileNameS']").each(function(){var b=$(this).val();a+=b.split("!")[1]+";"});return a}function exeStr(b){if(!b){return""}var a="";var c=b.split(",");if(c.length>0){for(i=0;i<c.length;i++){var f=c[i];if(!f){continue}var g=f.split("!");var d=g[0]+"|"+g[1];a+=d+";"}}a=a.substr(0,a.length-1);return a}function isHasAddFav(){var g=getUInfoFromECP("uname");var b=getUInfoFromECP("utype");var f=GetCookie("LID");if(!g||!b||b!="jf"){return false}var d=getBriefFilenames();$.ajax({url:"//ishufang.cnki.net/kpcapi/api/Favorite/IsFav",data:{type:"1",userId:encodeURIComponent(g),filenames:d,token:f},type:"GET",success:function(h){if(!!h.Data&&h.Data.length>0){a(h.Data)}}});function c(j){var h="";if(!!j){var k=j.split(";");for(i=0;i<k.length;i++){if(!!k[i]&&k[i].indexOf("|")>0){h+=k[i].split("|")[1]+";"}}}return h}function a(j){if(!j){return}var l=O2String(j);$("#addfavjson").attr("value",l);var k=0;$("input[name='FileNameS']").each(function(){var n=$(this).val();var m=$(this).parent().parent().find("td:last").find(".star:first");if(h(n,j)){m.html("已收藏");m.css("background-position-x","-20px")}});$(".GridSingleRow").each(function(){var n=$(this).find("input[name='FileNameS']").val();var m=$(this).find(".GridRightColumn:first").find(".GridContentDiv:first").find(".star:first");if(h(n,j)){m.html("已收藏");m.css("background-position-x","-20px")}});$(".GridDoubleRow").each(function(){var n=$(this).find("input[name='FileNameS']").val();var m=$(this).find(".GridRightColumn:first").find(".GridContentDiv:first").find(".star:first");if(h(n,j)){m.html("已收藏");m.css("background-position-x","-20px")}});function h(n,q){if(!q||!n){return false}for(k=0;k<q.length;k++){var m=q[k].fn.replace(/"/g,"").toLowerCase();var p=q[k].status;if(p==0&&n.toLowerCase().indexOf(m)>-1){return true}}return false}}}; 
 